
if (NOT WIN32)

	set (CL_API_HEADERS ${OCL_SOURCE_DIR}/cl_api)
	set (BUILD_LIB_SO ${CMAKE_CURRENT_BINARY_DIR}/../../framework/icd/libOpenCL.so)
	add_custom_target( SHOC_1_1_1 ALL
		COMMAND chmod +x configure
		
		COMMAND chmod +x tools/driver.pl
		COMMAND chmod +x tools/numatest.pl
		COMMAND chmod +x tools/prettyPrint.pl
		
		COMMAND rm -f /tmp/shoc/libOpenCL.so
		COMMAND ln -s ${BUILD_LIB_SO} /tmp/shoc/libOpenCL.so
		COMMAND ./configure --with-opencl CPPFLAGS=\"-I${CL_API_HEADERS} -DCL_USE_DEPRECATED_OPENCL_1_1_APIS\"
		
		COMMAND chmod +x Makefile
		COMMAND make
		
		DEPENDS OpenCL
		WORKING_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}
		)
		
	# FILE(GLOB SHOC_BINARIES RELATIVE ${CMAKE_CURRENT_SOURCE_DIR} bin/Serial/OpenCL/[^.]*)
	
	install(FILES bin/Serial/OpenCL/BusSpeedDownload DESTINATION bin/validation/shoc1.1.1/bin/Serial/OpenCL 
		PERMISSIONS OWNER_READ OWNER_WRITE OWNER_EXECUTE 
		GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE)
	install(FILES bin/Serial/OpenCL/BusSpeedReadback DESTINATION bin/validation/shoc1.1.1/bin/Serial/OpenCL 
		PERMISSIONS OWNER_READ OWNER_WRITE OWNER_EXECUTE 
		GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE)
	install(FILES bin/Serial/OpenCL/DeviceMemory DESTINATION bin/validation/shoc1.1.1/bin/Serial/OpenCL 
		PERMISSIONS OWNER_READ OWNER_WRITE OWNER_EXECUTE 
		GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE)
	install(FILES bin/Serial/OpenCL/FFT DESTINATION bin/validation/shoc1.1.1/bin/Serial/OpenCL 
		PERMISSIONS OWNER_READ OWNER_WRITE OWNER_EXECUTE 
		GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE)
	install(FILES bin/Serial/OpenCL/KernelCompile DESTINATION bin/validation/shoc1.1.1/bin/Serial/OpenCL 
		PERMISSIONS OWNER_READ OWNER_WRITE OWNER_EXECUTE 
		GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE)
	install(FILES bin/Serial/OpenCL/MaxFlops DESTINATION bin/validation/shoc1.1.1/bin/Serial/OpenCL 
		PERMISSIONS OWNER_READ OWNER_WRITE OWNER_EXECUTE 
		GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE)
	install(FILES bin/Serial/OpenCL/MD DESTINATION bin/validation/shoc1.1.1/bin/Serial/OpenCL 
		PERMISSIONS OWNER_READ OWNER_WRITE OWNER_EXECUTE 
		GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE)
	install(FILES bin/Serial/OpenCL/QueueDelay DESTINATION bin/validation/shoc1.1.1/bin/Serial/OpenCL 
		PERMISSIONS OWNER_READ OWNER_WRITE OWNER_EXECUTE 
		GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE)
	install(FILES bin/Serial/OpenCL/Reduction DESTINATION bin/validation/shoc1.1.1/bin/Serial/OpenCL 
		PERMISSIONS OWNER_READ OWNER_WRITE OWNER_EXECUTE 
		GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE)
	install(FILES bin/Serial/OpenCL/S3D DESTINATION bin/validation/shoc1.1.1/bin/Serial/OpenCL 
		PERMISSIONS OWNER_READ OWNER_WRITE OWNER_EXECUTE 
		GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE)
	install(FILES bin/Serial/OpenCL/Scan DESTINATION bin/validation/shoc1.1.1/bin/Serial/OpenCL 
		PERMISSIONS OWNER_READ OWNER_WRITE OWNER_EXECUTE 
		GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE)
	install(FILES bin/Serial/OpenCL/SGEMM DESTINATION bin/validation/shoc1.1.1/bin/Serial/OpenCL 
		PERMISSIONS OWNER_READ OWNER_WRITE OWNER_EXECUTE 
		GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE)
	install(FILES bin/Serial/OpenCL/Sort DESTINATION bin/validation/shoc1.1.1/bin/Serial/OpenCL 
		PERMISSIONS OWNER_READ OWNER_WRITE OWNER_EXECUTE 
		GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE)
	install(FILES bin/Serial/OpenCL/Spmv DESTINATION bin/validation/shoc1.1.1/bin/Serial/OpenCL 
		PERMISSIONS OWNER_READ OWNER_WRITE OWNER_EXECUTE 
		GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE)
	install(FILES bin/Serial/OpenCL/Stencil2D DESTINATION bin/validation/shoc1.1.1/bin/Serial/OpenCL 
		PERMISSIONS OWNER_READ OWNER_WRITE OWNER_EXECUTE 
		GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE)
	install(FILES bin/Serial/OpenCL/Triad DESTINATION bin/validation/shoc1.1.1/bin/Serial/OpenCL 
		PERMISSIONS OWNER_READ OWNER_WRITE OWNER_EXECUTE 
		GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE)
		
		
	set(SHOC_TOOLS ${CMAKE_CURRENT_SOURCE_DIR}/tools)
	set(INSTALL_SHOC_TOOLS bin/validation/shoc1.1.1/tools)
	file(GLOB_RECURSE SHOC_TOOLS_FILES RELATIVE ${CMAKE_CURRENT_SOURCE_DIR} tools/*.pl)
	install(FILES ${SHOC_TOOLS_FILES} DESTINATION ${INSTALL_SHOC_TOOLS}		 
		PERMISSIONS OWNER_READ OWNER_WRITE OWNER_EXECUTE 
		GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE)
	
	
endif (NOT WIN32)

                
