// -*- c++ -*-
// This code uses algorithm described in:
// "Fitting FFT onto G80 Architecture". Vasily Volkov and Brian Kazian, UC
// Berkeley CS258 project report. May 2008.
#ifdef SINGLE_PRECISION
#define T float
#define T2 float2
#elif K_DOUBLE_PRECISION
#pragma OPENCL EXTENSION cl_khr_fp64 : enable
#define T double
#define T2 double2
#elif AMD_DOUBLE_PRECISION
#pragma OPENCL EXTENSION cl_amd_fp64 : enable
#define T double
#define T2 double2
#endif
#ifndef M_PI
#define M_PI 3.14159265358979323846f
#endif
#ifndef M_SQRT1_2
#define M_SQRT1_2 0.70710678118654752440f
#endif
#define exp_1_8 (T2)(1, -1) // requires post-multiply by 1/sqrt(2)
#define exp_1_4 (T2)(0, -1)
#define exp_3_8 (T2)(-1, -1) // requires post-multiply by 1/sqrt(2)
#define iexp_1_8 (T2)(1, 1)  // requires post-multiply by 1/sqrt(2)
#define iexp_1_4 (T2)(0, 1)
#define iexp_3_8 (T2)(-1, 1) // requires post-multiply by 1/sqrt(2)
inline void globalLoads8(T2 *data, __global T2 *in, int stride) {
  for (int i = 0; i < 8; i++)
    data[i] = in[i * stride];
}
inline void globalLoads8_offset(T2 *data, __global T2 *in, int offset,
                                int stride) {
  for (int i = 0; i < 8; i++)
    data[i] = in[offset + i * stride];
}
inline void globalStores8(T2 *data, __global T2 *out, int stride) {
  int reversed[] = {0, 4, 2, 6, 1, 5, 3, 7};
  // #pragma unroll
  for (int i = 0; i < 8; i++)
    out[i * stride] = data[reversed[i]];
}
inline void globalStores8_offset(T2 *data, __global T2 *out, int offset,
                                 int stride) {
  int reversed[] = {0, 4, 2, 6, 1, 5, 3, 7};
  // #pragma unroll
  for (int i = 0; i < 8; i++)
    out[offset + i * stride] = data[reversed[i]];
}
inline void storex8(T2 *a, __local T *x, int sx) {
  int reversed[] = {0, 4, 2, 6, 1, 5, 3, 7};
  // #pragma unroll
  for (int i = 0; i < 8; i++)
    x[i * sx] = a[reversed[i]].x;
}
inline void storey8(T2 *a, __local T *x, int sx) {
  int reversed[] = {0, 4, 2, 6, 1, 5, 3, 7};
  // #pragma unroll
  for (int i = 0; i < 8; i++)
    x[i * sx] = a[reversed[i]].y;
}
inline void loadx8(T2 *a, __local T *x, int sx) {
  for (int i = 0; i < 8; i++)
    a[i].x = x[i * sx];
}
inline void loady8(T2 *a, __local T *x, int sx) {
  for (int i = 0; i < 8; i++)
    a[i].y = x[i * sx];
}
#define transpose(a, s, ds, l, dl, sync)                                       \
  {                                                                            \
    storex8(a, s, ds);                                                         \
    if ((sync)&8)                                                              \
      barrier(CLK_LOCAL_MEM_FENCE);                                            \
    loadx8(a, l, dl);                                                          \
    if ((sync)&4)                                                              \
      barrier(CLK_LOCAL_MEM_FENCE);                                            \
    storey8(a, s, ds);                                                         \
    if ((sync)&2)                                                              \
      barrier(CLK_LOCAL_MEM_FENCE);                                            \
    loady8(a, l, dl);                                                          \
    if ((sync)&1)                                                              \
      barrier(CLK_LOCAL_MEM_FENCE);                                            \
  }
inline T2 exp_i(T phi) {
  // #ifdef USE_NATIVE
  //     return (T2)( native_cos(phi), native_sin(phi) );
  // #else
  return (T2)(cos(phi), sin(phi));
  // #endif
}
inline T2 cmplx_mul(T2 a, T2 b) {
  return (T2)(a.x * b.x - a.y * b.y, a.x * b.y + a.y * b.x);
}
inline T2 cm_fl_mul(T2 a, T b) { return (T2)(b * a.x, b * a.y); }
inline T2 cmplx_add(T2 a, T2 b) { return (T2)(a.x + b.x, a.y + b.y); }
inline T2 cmplx_sub(T2 a, T2 b) { return (T2)(a.x - b.x, a.y - b.y); }
__constant T table_cos_64[64 * 7] = {
    1.000000000000000000000000000000,  1.000000000000000000000000000000,
    1.000000000000000000000000000000,  1.000000000000000000000000000000,
    1.000000000000000000000000000000,  1.000000000000000000000000000000,
    1.000000000000000000000000000000,  1.000000000000000000000000000000,
    0.923879532511286627460833642544,  0.923879532511286627460833642544,
    0.923879532511286627460833642544,  0.923879532511286627460833642544,
    0.923879532511286627460833642544,  0.923879532511286627460833642544,
    0.923879532511286627460833642544,  0.923879532511286627460833642544,
    0.707106781186547683759613391885,  0.707106781186547683759613391885,
    0.707106781186547683759613391885,  0.707106781186547683759613391885,
    0.707106781186547683759613391885,  0.707106781186547683759613391885,
    0.707106781186547683759613391885,  0.707106781186547683759613391885,
    0.382683432365089837290383911750,  0.382683432365089837290383911750,
    0.382683432365089837290383911750,  0.382683432365089837290383911750,
    0.382683432365089837290383911750,  0.382683432365089837290383911750,
    0.382683432365089837290383911750,  0.382683432365089837290383911750,
    0.000000000000000061232339957368,  0.000000000000000061232339957368,
    0.000000000000000061232339957368,  0.000000000000000061232339957368,
    0.000000000000000061232339957368,  0.000000000000000061232339957368,
    0.000000000000000061232339957368,  0.000000000000000061232339957368,
    -0.382683432365089726268081449234, -0.382683432365089726268081449234,
    -0.382683432365089726268081449234, -0.382683432365089726268081449234,
    -0.382683432365089726268081449234, -0.382683432365089726268081449234,
    -0.382683432365089726268081449234, -0.382683432365089726268081449234,
    -0.707106781186547461715008466854, -0.707106781186547461715008466854,
    -0.707106781186547461715008466854, -0.707106781186547461715008466854,
    -0.707106781186547461715008466854, -0.707106781186547461715008466854,
    -0.707106781186547461715008466854, -0.707106781186547461715008466854,
    -0.923879532511286627460833642544, -0.923879532511286627460833642544,
    -0.923879532511286627460833642544, -0.923879532511286627460833642544,
    -0.923879532511286627460833642544, -0.923879532511286627460833642544,
    -0.923879532511286627460833642544, -0.923879532511286627460833642544,
    1.000000000000000000000000000000,  1.000000000000000000000000000000,
    1.000000000000000000000000000000,  1.000000000000000000000000000000,
    1.000000000000000000000000000000,  1.000000000000000000000000000000,
    1.000000000000000000000000000000,  1.000000000000000000000000000000,
    0.980785280403230541601544700825,  0.980785280403230541601544700825,
    0.980785280403230541601544700825,  0.980785280403230541601544700825,
    0.980785280403230541601544700825,  0.980785280403230541601544700825,
    0.980785280403230541601544700825,  0.980785280403230541601544700825,
    0.923879532511286627460833642544,  0.923879532511286627460833642544,
    0.923879532511286627460833642544,  0.923879532511286627460833642544,
    0.923879532511286627460833642544,  0.923879532511286627460833642544,
    0.923879532511286627460833642544,  0.923879532511286627460833642544,
    0.831469612302545346693705141661,  0.831469612302545346693705141661,
    0.831469612302545346693705141661,  0.831469612302545346693705141661,
    0.831469612302545346693705141661,  0.831469612302545346693705141661,
    0.831469612302545346693705141661,  0.831469612302545346693705141661,
    0.707106781186547683759613391885,  0.707106781186547683759613391885,
    0.707106781186547683759613391885,  0.707106781186547683759613391885,
    0.707106781186547683759613391885,  0.707106781186547683759613391885,
    0.707106781186547683759613391885,  0.707106781186547683759613391885,
    0.555570233019602177648721408332,  0.555570233019602177648721408332,
    0.555570233019602177648721408332,  0.555570233019602177648721408332,
    0.555570233019602177648721408332,  0.555570233019602177648721408332,
    0.555570233019602177648721408332,  0.555570233019602177648721408332,
    0.382683432365089837290383911750,  0.382683432365089837290383911750,
    0.382683432365089837290383911750,  0.382683432365089837290383911750,
    0.382683432365089837290383911750,  0.382683432365089837290383911750,
    0.382683432365089837290383911750,  0.382683432365089837290383911750,
    0.195090322016128331350515168197,  0.195090322016128331350515168197,
    0.195090322016128331350515168197,  0.195090322016128331350515168197,
    0.195090322016128331350515168197,  0.195090322016128331350515168197,
    0.195090322016128331350515168197,  0.195090322016128331350515168197,
    1.000000000000000000000000000000,  1.000000000000000000000000000000,
    1.000000000000000000000000000000,  1.000000000000000000000000000000,
    1.000000000000000000000000000000,  1.000000000000000000000000000000,
    1.000000000000000000000000000000,  1.000000000000000000000000000000,
    0.831469612302545346693705141661,  0.831469612302545346693705141661,
    0.831469612302545346693705141661,  0.831469612302545346693705141661,
    0.831469612302545346693705141661,  0.831469612302545346693705141661,
    0.831469612302545346693705141661,  0.831469612302545346693705141661,
    0.382683432365089837290383911750,  0.382683432365089837290383911750,
    0.382683432365089837290383911750,  0.382683432365089837290383911750,
    0.382683432365089837290383911750,  0.382683432365089837290383911750,
    0.382683432365089837290383911750,  0.382683432365089837290383911750,
    -0.195090322016128220328212705681, -0.195090322016128220328212705681,
    -0.195090322016128220328212705681, -0.195090322016128220328212705681,
    -0.195090322016128220328212705681, -0.195090322016128220328212705681,
    -0.195090322016128220328212705681, -0.195090322016128220328212705681,
    -0.707106781186547461715008466854, -0.707106781186547461715008466854,
    -0.707106781186547461715008466854, -0.707106781186547461715008466854,
    -0.707106781186547461715008466854, -0.707106781186547461715008466854,
    -0.707106781186547461715008466854, -0.707106781186547461715008466854,
    -0.980785280403230430579242238309, -0.980785280403230430579242238309,
    -0.980785280403230430579242238309, -0.980785280403230430579242238309,
    -0.980785280403230430579242238309, -0.980785280403230430579242238309,
    -0.980785280403230430579242238309, -0.980785280403230430579242238309,
    -0.923879532511286738483136105060, -0.923879532511286738483136105060,
    -0.923879532511286738483136105060, -0.923879532511286738483136105060,
    -0.923879532511286738483136105060, -0.923879532511286738483136105060,
    -0.923879532511286738483136105060, -0.923879532511286738483136105060,
    -0.555570233019602066626418945816, -0.555570233019602066626418945816,
    -0.555570233019602066626418945816, -0.555570233019602066626418945816,
    -0.555570233019602066626418945816, -0.555570233019602066626418945816,
    -0.555570233019602066626418945816, -0.555570233019602066626418945816,
    1.000000000000000000000000000000,  1.000000000000000000000000000000,
    1.000000000000000000000000000000,  1.000000000000000000000000000000,
    1.000000000000000000000000000000,  1.000000000000000000000000000000,
    1.000000000000000000000000000000,  1.000000000000000000000000000000,
    0.995184726672196817709448168898,  0.995184726672196817709448168898,
    0.995184726672196817709448168898,  0.995184726672196817709448168898,
    0.995184726672196817709448168898,  0.995184726672196817709448168898,
    0.995184726672196817709448168898,  0.995184726672196817709448168898,
    0.980785280403230541601544700825,  0.980785280403230541601544700825,
    0.980785280403230541601544700825,  0.980785280403230541601544700825,
    0.980785280403230541601544700825,  0.980785280403230541601544700825,
    0.980785280403230541601544700825,  0.980785280403230541601544700825,
    0.956940335732209046426532950136,  0.956940335732209046426532950136,
    0.956940335732209046426532950136,  0.956940335732209046426532950136,
    0.956940335732209046426532950136,  0.956940335732209046426532950136,
    0.956940335732209046426532950136,  0.956940335732209046426532950136,
    0.923879532511286627460833642544,  0.923879532511286627460833642544,
    0.923879532511286627460833642544,  0.923879532511286627460833642544,
    0.923879532511286627460833642544,  0.923879532511286627460833642544,
    0.923879532511286627460833642544,  0.923879532511286627460833642544,
    0.881921264348354827511400344520,  0.881921264348354827511400344520,
    0.881921264348354827511400344520,  0.881921264348354827511400344520,
    0.881921264348354827511400344520,  0.881921264348354827511400344520,
    0.881921264348354827511400344520,  0.881921264348354827511400344520,
    0.831469612302545346693705141661,  0.831469612302545346693705141661,
    0.831469612302545346693705141661,  0.831469612302545346693705141661,
    0.831469612302545346693705141661,  0.831469612302545346693705141661,
    0.831469612302545346693705141661,  0.831469612302545346693705141661,
    0.773010453362737104399116105924,  0.773010453362737104399116105924,
    0.773010453362737104399116105924,  0.773010453362737104399116105924,
    0.773010453362737104399116105924,  0.773010453362737104399116105924,
    0.773010453362737104399116105924,  0.773010453362737104399116105924,
    1.000000000000000000000000000000,  1.000000000000000000000000000000,
    1.000000000000000000000000000000,  1.000000000000000000000000000000,
    1.000000000000000000000000000000,  1.000000000000000000000000000000,
    1.000000000000000000000000000000,  1.000000000000000000000000000000,
    0.881921264348354827511400344520,  0.881921264348354827511400344520,
    0.881921264348354827511400344520,  0.881921264348354827511400344520,
    0.881921264348354827511400344520,  0.881921264348354827511400344520,
    0.881921264348354827511400344520,  0.881921264348354827511400344520,
    0.555570233019602177648721408332,  0.555570233019602177648721408332,
    0.555570233019602177648721408332,  0.555570233019602177648721408332,
    0.555570233019602177648721408332,  0.555570233019602177648721408332,
    0.555570233019602177648721408332,  0.555570233019602177648721408332,
    0.098017140329560770162231619906,  0.098017140329560770162231619906,
    0.098017140329560770162231619906,  0.098017140329560770162231619906,
    0.098017140329560770162231619906,  0.098017140329560770162231619906,
    0.098017140329560770162231619906,  0.098017140329560770162231619906,
    -0.382683432365089726268081449234, -0.382683432365089726268081449234,
    -0.382683432365089726268081449234, -0.382683432365089726268081449234,
    -0.382683432365089726268081449234, -0.382683432365089726268081449234,
    -0.382683432365089726268081449234, -0.382683432365089726268081449234,
    -0.773010453362737104399116105924, -0.773010453362737104399116105924,
    -0.773010453362737104399116105924, -0.773010453362737104399116105924,
    -0.773010453362737104399116105924, -0.773010453362737104399116105924,
    -0.773010453362737104399116105924, -0.773010453362737104399116105924,
    -0.980785280403230430579242238309, -0.980785280403230430579242238309,
    -0.980785280403230430579242238309, -0.980785280403230430579242238309,
    -0.980785280403230430579242238309, -0.980785280403230430579242238309,
    -0.980785280403230430579242238309, -0.980785280403230430579242238309,
    -0.956940335732209046426532950136, -0.956940335732209046426532950136,
    -0.956940335732209046426532950136, -0.956940335732209046426532950136,
    -0.956940335732209046426532950136, -0.956940335732209046426532950136,
    -0.956940335732209046426532950136, -0.956940335732209046426532950136,
    1.000000000000000000000000000000,  1.000000000000000000000000000000,
    1.000000000000000000000000000000,  1.000000000000000000000000000000,
    1.000000000000000000000000000000,  1.000000000000000000000000000000,
    1.000000000000000000000000000000,  1.000000000000000000000000000000,
    0.956940335732209046426532950136,  0.956940335732209046426532950136,
    0.956940335732209046426532950136,  0.956940335732209046426532950136,
    0.956940335732209046426532950136,  0.956940335732209046426532950136,
    0.956940335732209046426532950136,  0.956940335732209046426532950136,
    0.831469612302545346693705141661,  0.831469612302545346693705141661,
    0.831469612302545346693705141661,  0.831469612302545346693705141661,
    0.831469612302545346693705141661,  0.831469612302545346693705141661,
    0.831469612302545346693705141661,  0.831469612302545346693705141661,
    0.634393284163645487794269683945,  0.634393284163645487794269683945,
    0.634393284163645487794269683945,  0.634393284163645487794269683945,
    0.634393284163645487794269683945,  0.634393284163645487794269683945,
    0.634393284163645487794269683945,  0.634393284163645487794269683945,
    0.382683432365089837290383911750,  0.382683432365089837290383911750,
    0.382683432365089837290383911750,  0.382683432365089837290383911750,
    0.382683432365089837290383911750,  0.382683432365089837290383911750,
    0.382683432365089837290383911750,  0.382683432365089837290383911750,
    0.098017140329560770162231619906,  0.098017140329560770162231619906,
    0.098017140329560770162231619906,  0.098017140329560770162231619906,
    0.098017140329560770162231619906,  0.098017140329560770162231619906,
    0.098017140329560770162231619906,  0.098017140329560770162231619906,
    -0.195090322016128220328212705681, -0.195090322016128220328212705681,
    -0.195090322016128220328212705681, -0.195090322016128220328212705681,
    -0.195090322016128220328212705681, -0.195090322016128220328212705681,
    -0.195090322016128220328212705681, -0.195090322016128220328212705681,
    -0.471396736825997642039709489836, -0.471396736825997642039709489836,
    -0.471396736825997642039709489836, -0.471396736825997642039709489836,
    -0.471396736825997642039709489836, -0.471396736825997642039709489836,
    -0.471396736825997642039709489836, -0.471396736825997642039709489836,
    1.000000000000000000000000000000,  1.000000000000000000000000000000,
    1.000000000000000000000000000000,  1.000000000000000000000000000000,
    1.000000000000000000000000000000,  1.000000000000000000000000000000,
    1.000000000000000000000000000000,  1.000000000000000000000000000000,
    0.773010453362737104399116105924,  0.773010453362737104399116105924,
    0.773010453362737104399116105924,  0.773010453362737104399116105924,
    0.773010453362737104399116105924,  0.773010453362737104399116105924,
    0.773010453362737104399116105924,  0.773010453362737104399116105924,
    0.195090322016128331350515168197,  0.195090322016128331350515168197,
    0.195090322016128331350515168197,  0.195090322016128331350515168197,
    0.195090322016128331350515168197,  0.195090322016128331350515168197,
    0.195090322016128331350515168197,  0.195090322016128331350515168197,
    -0.471396736825997642039709489836, -0.471396736825997642039709489836,
    -0.471396736825997642039709489836, -0.471396736825997642039709489836,
    -0.471396736825997642039709489836, -0.471396736825997642039709489836,
    -0.471396736825997642039709489836, -0.471396736825997642039709489836,
    -0.923879532511286627460833642544, -0.923879532511286627460833642544,
    -0.923879532511286627460833642544, -0.923879532511286627460833642544,
    -0.923879532511286627460833642544, -0.923879532511286627460833642544,
    -0.923879532511286627460833642544, -0.923879532511286627460833642544,
    -0.956940335732209046426532950136, -0.956940335732209046426532950136,
    -0.956940335732209046426532950136, -0.956940335732209046426532950136,
    -0.956940335732209046426532950136, -0.956940335732209046426532950136,
    -0.956940335732209046426532950136, -0.956940335732209046426532950136,
    -0.555570233019602066626418945816, -0.555570233019602066626418945816,
    -0.555570233019602066626418945816, -0.555570233019602066626418945816,
    -0.555570233019602066626418945816, -0.555570233019602066626418945816,
    -0.555570233019602066626418945816, -0.555570233019602066626418945816,
    0.098017140329560090150629036998,  0.098017140329560090150629036998,
    0.098017140329560090150629036998,  0.098017140329560090150629036998,
    0.098017140329560090150629036998,  0.098017140329560090150629036998,
    0.098017140329560090150629036998,  0.098017140329560090150629036998};
__constant T table_sin_64[64 * 7] = {
    -0.000000000000000000000000000000, -0.000000000000000000000000000000,
    -0.000000000000000000000000000000, -0.000000000000000000000000000000,
    -0.000000000000000000000000000000, -0.000000000000000000000000000000,
    -0.000000000000000000000000000000, -0.000000000000000000000000000000,
    -0.382683432365089781779232680492, -0.382683432365089781779232680492,
    -0.382683432365089781779232680492, -0.382683432365089781779232680492,
    -0.382683432365089781779232680492, -0.382683432365089781779232680492,
    -0.382683432365089781779232680492, -0.382683432365089781779232680492,
    -0.707106781186547572737310929369, -0.707106781186547572737310929369,
    -0.707106781186547572737310929369, -0.707106781186547572737310929369,
    -0.707106781186547572737310929369, -0.707106781186547572737310929369,
    -0.707106781186547572737310929369, -0.707106781186547572737310929369,
    -0.923879532511286627460833642544, -0.923879532511286627460833642544,
    -0.923879532511286627460833642544, -0.923879532511286627460833642544,
    -0.923879532511286627460833642544, -0.923879532511286627460833642544,
    -0.923879532511286627460833642544, -0.923879532511286627460833642544,
    -1.000000000000000000000000000000, -1.000000000000000000000000000000,
    -1.000000000000000000000000000000, -1.000000000000000000000000000000,
    -1.000000000000000000000000000000, -1.000000000000000000000000000000,
    -1.000000000000000000000000000000, -1.000000000000000000000000000000,
    -0.923879532511286738483136105060, -0.923879532511286738483136105060,
    -0.923879532511286738483136105060, -0.923879532511286738483136105060,
    -0.923879532511286738483136105060, -0.923879532511286738483136105060,
    -0.923879532511286738483136105060, -0.923879532511286738483136105060,
    -0.707106781186547683759613391885, -0.707106781186547683759613391885,
    -0.707106781186547683759613391885, -0.707106781186547683759613391885,
    -0.707106781186547683759613391885, -0.707106781186547683759613391885,
    -0.707106781186547683759613391885, -0.707106781186547683759613391885,
    -0.382683432365089892801535143008, -0.382683432365089892801535143008,
    -0.382683432365089892801535143008, -0.382683432365089892801535143008,
    -0.382683432365089892801535143008, -0.382683432365089892801535143008,
    -0.382683432365089892801535143008, -0.382683432365089892801535143008,
    -0.000000000000000000000000000000, -0.000000000000000000000000000000,
    -0.000000000000000000000000000000, -0.000000000000000000000000000000,
    -0.000000000000000000000000000000, -0.000000000000000000000000000000,
    -0.000000000000000000000000000000, -0.000000000000000000000000000000,
    -0.195090322016128275839363936939, -0.195090322016128275839363936939,
    -0.195090322016128275839363936939, -0.195090322016128275839363936939,
    -0.195090322016128275839363936939, -0.195090322016128275839363936939,
    -0.195090322016128275839363936939, -0.195090322016128275839363936939,
    -0.382683432365089781779232680492, -0.382683432365089781779232680492,
    -0.382683432365089781779232680492, -0.382683432365089781779232680492,
    -0.382683432365089781779232680492, -0.382683432365089781779232680492,
    -0.382683432365089781779232680492, -0.382683432365089781779232680492,
    -0.555570233019602066626418945816, -0.555570233019602066626418945816,
    -0.555570233019602066626418945816, -0.555570233019602066626418945816,
    -0.555570233019602066626418945816, -0.555570233019602066626418945816,
    -0.555570233019602066626418945816, -0.555570233019602066626418945816,
    -0.707106781186547572737310929369, -0.707106781186547572737310929369,
    -0.707106781186547572737310929369, -0.707106781186547572737310929369,
    -0.707106781186547572737310929369, -0.707106781186547572737310929369,
    -0.707106781186547572737310929369, -0.707106781186547572737310929369,
    -0.831469612302545235671402679145, -0.831469612302545235671402679145,
    -0.831469612302545235671402679145, -0.831469612302545235671402679145,
    -0.831469612302545235671402679145, -0.831469612302545235671402679145,
    -0.831469612302545235671402679145, -0.831469612302545235671402679145,
    -0.923879532511286627460833642544, -0.923879532511286627460833642544,
    -0.923879532511286627460833642544, -0.923879532511286627460833642544,
    -0.923879532511286627460833642544, -0.923879532511286627460833642544,
    -0.923879532511286627460833642544, -0.923879532511286627460833642544,
    -0.980785280403230541601544700825, -0.980785280403230541601544700825,
    -0.980785280403230541601544700825, -0.980785280403230541601544700825,
    -0.980785280403230541601544700825, -0.980785280403230541601544700825,
    -0.980785280403230541601544700825, -0.980785280403230541601544700825,
    -0.000000000000000000000000000000, -0.000000000000000000000000000000,
    -0.000000000000000000000000000000, -0.000000000000000000000000000000,
    -0.000000000000000000000000000000, -0.000000000000000000000000000000,
    -0.000000000000000000000000000000, -0.000000000000000000000000000000,
    -0.555570233019602066626418945816, -0.555570233019602066626418945816,
    -0.555570233019602066626418945816, -0.555570233019602066626418945816,
    -0.555570233019602066626418945816, -0.555570233019602066626418945816,
    -0.555570233019602066626418945816, -0.555570233019602066626418945816,
    -0.923879532511286627460833642544, -0.923879532511286627460833642544,
    -0.923879532511286627460833642544, -0.923879532511286627460833642544,
    -0.923879532511286627460833642544, -0.923879532511286627460833642544,
    -0.923879532511286627460833642544, -0.923879532511286627460833642544,
    -0.980785280403230541601544700825, -0.980785280403230541601544700825,
    -0.980785280403230541601544700825, -0.980785280403230541601544700825,
    -0.980785280403230541601544700825, -0.980785280403230541601544700825,
    -0.980785280403230541601544700825, -0.980785280403230541601544700825,
    -0.707106781186547683759613391885, -0.707106781186547683759613391885,
    -0.707106781186547683759613391885, -0.707106781186547683759613391885,
    -0.707106781186547683759613391885, -0.707106781186547683759613391885,
    -0.707106781186547683759613391885, -0.707106781186547683759613391885,
    -0.195090322016128608906271324486, -0.195090322016128608906271324486,
    -0.195090322016128608906271324486, -0.195090322016128608906271324486,
    -0.195090322016128608906271324486, -0.195090322016128608906271324486,
    -0.195090322016128608906271324486, -0.195090322016128608906271324486,
    0.382683432365089670756930217976,  0.382683432365089670756930217976,
    0.382683432365089670756930217976,  0.382683432365089670756930217976,
    0.382683432365089670756930217976,  0.382683432365089670756930217976,
    0.382683432365089670756930217976,  0.382683432365089670756930217976,
    0.831469612302545346693705141661,  0.831469612302545346693705141661,
    0.831469612302545346693705141661,  0.831469612302545346693705141661,
    0.831469612302545346693705141661,  0.831469612302545346693705141661,
    0.831469612302545346693705141661,  0.831469612302545346693705141661,
    -0.000000000000000000000000000000, -0.000000000000000000000000000000,
    -0.000000000000000000000000000000, -0.000000000000000000000000000000,
    -0.000000000000000000000000000000, -0.000000000000000000000000000000,
    -0.000000000000000000000000000000, -0.000000000000000000000000000000,
    -0.098017140329560603628777926133, -0.098017140329560603628777926133,
    -0.098017140329560603628777926133, -0.098017140329560603628777926133,
    -0.098017140329560603628777926133, -0.098017140329560603628777926133,
    -0.098017140329560603628777926133, -0.098017140329560603628777926133,
    -0.195090322016128275839363936939, -0.195090322016128275839363936939,
    -0.195090322016128275839363936939, -0.195090322016128275839363936939,
    -0.195090322016128275839363936939, -0.195090322016128275839363936939,
    -0.195090322016128275839363936939, -0.195090322016128275839363936939,
    -0.290284677254462386564171083592, -0.290284677254462386564171083592,
    -0.290284677254462386564171083592, -0.290284677254462386564171083592,
    -0.290284677254462386564171083592, -0.290284677254462386564171083592,
    -0.290284677254462386564171083592, -0.290284677254462386564171083592,
    -0.382683432365089781779232680492, -0.382683432365089781779232680492,
    -0.382683432365089781779232680492, -0.382683432365089781779232680492,
    -0.382683432365089781779232680492, -0.382683432365089781779232680492,
    -0.382683432365089781779232680492, -0.382683432365089781779232680492,
    -0.471396736825997586528558258578, -0.471396736825997586528558258578,
    -0.471396736825997586528558258578, -0.471396736825997586528558258578,
    -0.471396736825997586528558258578, -0.471396736825997586528558258578,
    -0.471396736825997586528558258578, -0.471396736825997586528558258578,
    -0.555570233019602066626418945816, -0.555570233019602066626418945816,
    -0.555570233019602066626418945816, -0.555570233019602066626418945816,
    -0.555570233019602066626418945816, -0.555570233019602066626418945816,
    -0.555570233019602066626418945816, -0.555570233019602066626418945816,
    -0.634393284163645376771967221430, -0.634393284163645376771967221430,
    -0.634393284163645376771967221430, -0.634393284163645376771967221430,
    -0.634393284163645376771967221430, -0.634393284163645376771967221430,
    -0.634393284163645376771967221430, -0.634393284163645376771967221430,
    -0.000000000000000000000000000000, -0.000000000000000000000000000000,
    -0.000000000000000000000000000000, -0.000000000000000000000000000000,
    -0.000000000000000000000000000000, -0.000000000000000000000000000000,
    -0.000000000000000000000000000000, -0.000000000000000000000000000000,
    -0.471396736825997586528558258578, -0.471396736825997586528558258578,
    -0.471396736825997586528558258578, -0.471396736825997586528558258578,
    -0.471396736825997586528558258578, -0.471396736825997586528558258578,
    -0.471396736825997586528558258578, -0.471396736825997586528558258578,
    -0.831469612302545235671402679145, -0.831469612302545235671402679145,
    -0.831469612302545235671402679145, -0.831469612302545235671402679145,
    -0.831469612302545235671402679145, -0.831469612302545235671402679145,
    -0.831469612302545235671402679145, -0.831469612302545235671402679145,
    -0.995184726672196817709448168898, -0.995184726672196817709448168898,
    -0.995184726672196817709448168898, -0.995184726672196817709448168898,
    -0.995184726672196817709448168898, -0.995184726672196817709448168898,
    -0.995184726672196817709448168898, -0.995184726672196817709448168898,
    -0.923879532511286738483136105060, -0.923879532511286738483136105060,
    -0.923879532511286738483136105060, -0.923879532511286738483136105060,
    -0.923879532511286738483136105060, -0.923879532511286738483136105060,
    -0.923879532511286738483136105060, -0.923879532511286738483136105060,
    -0.634393284163645376771967221430, -0.634393284163645376771967221430,
    -0.634393284163645376771967221430, -0.634393284163645376771967221430,
    -0.634393284163645376771967221430, -0.634393284163645376771967221430,
    -0.634393284163645376771967221430, -0.634393284163645376771967221430,
    -0.195090322016128608906271324486, -0.195090322016128608906271324486,
    -0.195090322016128608906271324486, -0.195090322016128608906271324486,
    -0.195090322016128608906271324486, -0.195090322016128608906271324486,
    -0.195090322016128608906271324486, -0.195090322016128608906271324486,
    0.290284677254462164519566158560,  0.290284677254462164519566158560,
    0.290284677254462164519566158560,  0.290284677254462164519566158560,
    0.290284677254462164519566158560,  0.290284677254462164519566158560,
    0.290284677254462164519566158560,  0.290284677254462164519566158560,
    -0.000000000000000000000000000000, -0.000000000000000000000000000000,
    -0.000000000000000000000000000000, -0.000000000000000000000000000000,
    -0.000000000000000000000000000000, -0.000000000000000000000000000000,
    -0.000000000000000000000000000000, -0.000000000000000000000000000000,
    -0.290284677254462386564171083592, -0.290284677254462386564171083592,
    -0.290284677254462386564171083592, -0.290284677254462386564171083592,
    -0.290284677254462386564171083592, -0.290284677254462386564171083592,
    -0.290284677254462386564171083592, -0.290284677254462386564171083592,
    -0.555570233019602066626418945816, -0.555570233019602066626418945816,
    -0.555570233019602066626418945816, -0.555570233019602066626418945816,
    -0.555570233019602066626418945816, -0.555570233019602066626418945816,
    -0.555570233019602066626418945816, -0.555570233019602066626418945816,
    -0.773010453362737104399116105924, -0.773010453362737104399116105924,
    -0.773010453362737104399116105924, -0.773010453362737104399116105924,
    -0.773010453362737104399116105924, -0.773010453362737104399116105924,
    -0.773010453362737104399116105924, -0.773010453362737104399116105924,
    -0.923879532511286627460833642544, -0.923879532511286627460833642544,
    -0.923879532511286627460833642544, -0.923879532511286627460833642544,
    -0.923879532511286627460833642544, -0.923879532511286627460833642544,
    -0.923879532511286627460833642544, -0.923879532511286627460833642544,
    -0.995184726672196817709448168898, -0.995184726672196817709448168898,
    -0.995184726672196817709448168898, -0.995184726672196817709448168898,
    -0.995184726672196817709448168898, -0.995184726672196817709448168898,
    -0.995184726672196817709448168898, -0.995184726672196817709448168898,
    -0.980785280403230541601544700825, -0.980785280403230541601544700825,
    -0.980785280403230541601544700825, -0.980785280403230541601544700825,
    -0.980785280403230541601544700825, -0.980785280403230541601544700825,
    -0.980785280403230541601544700825, -0.980785280403230541601544700825,
    -0.881921264348354938533702807035, -0.881921264348354938533702807035,
    -0.881921264348354938533702807035, -0.881921264348354938533702807035,
    -0.881921264348354938533702807035, -0.881921264348354938533702807035,
    -0.881921264348354938533702807035, -0.881921264348354938533702807035,
    -0.000000000000000000000000000000, -0.000000000000000000000000000000,
    -0.000000000000000000000000000000, -0.000000000000000000000000000000,
    -0.000000000000000000000000000000, -0.000000000000000000000000000000,
    -0.000000000000000000000000000000, -0.000000000000000000000000000000,
    -0.634393284163645376771967221430, -0.634393284163645376771967221430,
    -0.634393284163645376771967221430, -0.634393284163645376771967221430,
    -0.634393284163645376771967221430, -0.634393284163645376771967221430,
    -0.634393284163645376771967221430, -0.634393284163645376771967221430,
    -0.980785280403230541601544700825, -0.980785280403230541601544700825,
    -0.980785280403230541601544700825, -0.980785280403230541601544700825,
    -0.980785280403230541601544700825, -0.980785280403230541601544700825,
    -0.980785280403230541601544700825, -0.980785280403230541601544700825,
    -0.881921264348354938533702807035, -0.881921264348354938533702807035,
    -0.881921264348354938533702807035, -0.881921264348354938533702807035,
    -0.881921264348354938533702807035, -0.881921264348354938533702807035,
    -0.881921264348354938533702807035, -0.881921264348354938533702807035,
    -0.382683432365089892801535143008, -0.382683432365089892801535143008,
    -0.382683432365089892801535143008, -0.382683432365089892801535143008,
    -0.382683432365089892801535143008, -0.382683432365089892801535143008,
    -0.382683432365089892801535143008, -0.382683432365089892801535143008,
    0.290284677254462164519566158560,  0.290284677254462164519566158560,
    0.290284677254462164519566158560,  0.290284677254462164519566158560,
    0.290284677254462164519566158560,  0.290284677254462164519566158560,
    0.290284677254462164519566158560,  0.290284677254462164519566158560,
    0.831469612302545346693705141661,  0.831469612302545346693705141661,
    0.831469612302545346693705141661,  0.831469612302545346693705141661,
    0.831469612302545346693705141661,  0.831469612302545346693705141661,
    0.831469612302545346693705141661,  0.831469612302545346693705141661,
    0.995184726672196817709448168898,  0.995184726672196817709448168898,
    0.995184726672196817709448168898,  0.995184726672196817709448168898,
    0.995184726672196817709448168898,  0.995184726672196817709448168898,
    0.995184726672196817709448168898,  0.995184726672196817709448168898};
__constant T table_cos_512[64 * 7] = {
    1.000000000000000000000000000000,  0.998795456205172516028767404350,
    0.995184726672196817709448168898,  0.989176509964780903416681212548,
    0.980785280403230541601544700825,  0.970031253194544085260986321373,
    0.956940335732209046426532950136,  0.941544065183020806308888950298,
    0.923879532511286627460833642544,  0.903989293123443116151349840948,
    0.881921264348354827511400344520,  0.857728610000272007063415458106,
    0.831469612302545346693705141661,  0.803207531480645053889588780294,
    0.773010453362737104399116105924,  0.740951125354959327928838774824,
    0.707106781186547683759613391885,  0.671558954847018441114414599724,
    0.634393284163645487794269683945,  0.595699304492433356905678465409,
    0.555570233019602177648721408332,  0.514102744193221661284098900069,
    0.471396736825997753062011952352,  0.427555093430282195932079503109,
    0.382683432365089837290383911750,  0.336889853392220106620413844212,
    0.290284677254462331053019852334,  0.242980179903264037477583769942,
    0.195090322016128331350515168197,  0.146730474455361747931902982600,
    0.098017140329560770162231619906,  0.049067674327418132895761715417,
    0.000000000000000061232339957368,  -0.049067674327418007995671445087,
    -0.098017140329560659139929157391, -0.146730474455361636909600520084,
    -0.195090322016128220328212705681, -0.242980179903263926455281307426,
    -0.290284677254462220030717389818, -0.336889853392219995598111381696,
    -0.382683432365089726268081449234, -0.427555093430281862865172115562,
    -0.471396736825997642039709489836, -0.514102744193221550261796437553,
    -0.555570233019601844581814020785, -0.595699304492433245883376002894,
    -0.634393284163645265749664758914, -0.671558954847018441114414599724,
    -0.707106781186547461715008466854, -0.740951125354958994861931387277,
    -0.773010453362737104399116105924, -0.803207531480644942867286317778,
    -0.831469612302545346693705141661, -0.857728610000272007063415458106,
    -0.881921264348354827511400344520, -0.903989293123443227173652303463,
    -0.923879532511286627460833642544, -0.941544065183020695286586487782,
    -0.956940335732209046426532950136, -0.970031253194544085260986321373,
    -0.980785280403230430579242238309, -0.989176509964780903416681212548,
    -0.995184726672196817709448168898, -0.998795456205172405006464941835,
    1.000000000000000000000000000000,  0.999698818696204472011856978497,
    0.998795456205172516028767404350,  0.997290456678690095948525140557,
    0.995184726672196817709448168898,  0.992479534598709856041409693717,
    0.989176509964780903416681212548,  0.985277642388941221618381405278,
    0.980785280403230541601544700825,  0.975702130038528792077556772711,
    0.970031253194544085260986321373,  0.963776065795440062267118719319,
    0.956940335732209046426532950136,  0.949528180593036785772653729509,
    0.941544065183020806308888950298,  0.932992798834738845670244700159,
    0.923879532511286627460833642544,  0.914209755703530579928894894692,
    0.903989293123443116151349840948,  0.893224301195515213436237900169,
    0.881921264348354827511400344520,  0.870086991108711238496198348003,
    0.857728610000272007063415458106,  0.844853565249707116890931501985,
    0.831469612302545346693705141661,  0.817584813151583822410373159073,
    0.803207531480645053889588780294,  0.788346427626606449656776476331,
    0.773010453362737104399116105924,  0.757208846506484678506865293457,
    0.740951125354959327928838774824,  0.724247082951467113787202833919,
    0.707106781186547683759613391885,  0.689540544737066940506053924764,
    0.671558954847018441114414599724,  0.653172842953776866536941270169,
    0.634393284163645487794269683945,  0.615231590580626819253495796147,
    0.595699304492433356905678465409,  0.575808191417845338655467912758,
    0.555570233019602177648721408332,  0.534997619887097264346209612995,
    0.514102744193221661284098900069,  0.492898192229784093409961087673,
    0.471396736825997753062011952352,  0.449611329654606595163102156221,
    0.427555093430282195932079503109,  0.405241314004989860997341111215,
    0.382683432365089837290383911750,  0.359895036534988277399094158682,
    0.336889853392220106620413844212,  0.313681740398891573118334008541,
    0.290284677254462331053019852334,  0.266712757474898420895215167548,
    0.242980179903264037477583769942,  0.219101240156869797592875670489,
    0.195090322016128331350515168197,  0.170961888760301383705098032806,
    0.146730474455361747931902982600,  0.122410675199216278929981172041,
    0.098017140329560770162231619906,  0.073564563599667454063535387832,
    0.049067674327418132895761715417,  0.024541228522912267306921307863,
    1.000000000000000000000000000000,  0.997290456678690095948525140557,
    0.989176509964780903416681212548,  0.975702130038528792077556772711,
    0.956940335732209046426532950136,  0.932992798834738845670244700159,
    0.903989293123443116151349840948,  0.870086991108711238496198348003,
    0.831469612302545346693705141661,  0.788346427626606449656776476331,
    0.740951125354959327928838774824,  0.689540544737066940506053924764,
    0.634393284163645487794269683945,  0.575808191417845338655467912758,
    0.514102744193221661284098900069,  0.449611329654606595163102156221,
    0.382683432365089837290383911750,  0.313681740398891573118334008541,
    0.242980179903264037477583769942,  0.170961888760301383705098032806,
    0.098017140329560770162231619906,  0.024541228522912267306921307863,
    -0.049067674327418007995671445087, -0.122410675199216167907678709525,
    -0.195090322016128220328212705681, -0.266712757474898309872912705032,
    -0.336889853392219995598111381696, -0.405241314004989749975038648699,
    -0.471396736825997642039709489836, -0.534997619887096931279302225448,
    -0.595699304492433245883376002894, -0.653172842953776422447731420107,
    -0.707106781186547461715008466854, -0.757208846506484678506865293457,
    -0.803207531480644942867286317778, -0.844853565249707116890931501985,
    -0.881921264348354827511400344520, -0.914209755703530579928894894692,
    -0.941544065183020695286586487782, -0.963776065795440062267118719319,
    -0.980785280403230430579242238309, -0.992479534598709856041409693717,
    -0.998795456205172405006464941835, -0.999698818696204472011856978497,
    -0.995184726672196706687145706383, -0.985277642388941332640683867794,
    -0.970031253194544196283288783889, -0.949528180593036896794956192025,
    -0.923879532511286738483136105060, -0.893224301195515213436237900169,
    -0.857728610000272118085717920621, -0.817584813151583822410373159073,
    -0.773010453362737326443721030955, -0.724247082951467113787202833919,
    -0.671558954847018663159019524755, -0.615231590580627263342705646210,
    -0.555570233019602066626418945816, -0.492898192229784204432263550189,
    -0.427555093430282473487835659398, -0.359895036534987999843338002393,
    -0.290284677254462442075322314849, -0.219101240156870158415358673665,
    -0.146730474455362330798990910807, -0.073564563599667356919020733130,
    1.000000000000000000000000000000,  0.999924701839144614012866441044,
    0.999698818696204472011856978497,  0.999322384588349654777061914501,
    0.998795456205172516028767404350,  0.998118112900149290211970765085,
    0.997290456678690095948525140557,  0.996312612182777890268425835529,
    0.995184726672196817709448168898,  0.993906970002355838467167359340,
    0.992479534598709856041409693717,  0.990902635427779898691369453445,
    0.989176509964780903416681212548,  0.987301418157858323709774595045,
    0.985277642388941221618381405278,  0.983105487431216396032596094301,
    0.980785280403230541601544700825,  0.978317370719627765751624792756,
    0.975702130038528792077556772711,  0.972939952205560287801233698701,
    0.970031253194544085260986321373,  0.966976471044852292635596313630,
    0.963776065795440062267118719319,  0.960430519415566008589735247369,
    0.956940335732209046426532950136,  0.953306040354193862107479162660,
    0.949528180593036785772653729509,  0.945607325380521390734145370516,
    0.941544065183020806308888950298,  0.937339011912574737728220952704,
    0.932992798834738845670244700159,  0.928506080473215478221504781686,
    0.923879532511286627460833642544,  0.919113851690057659382659949188,
    0.914209755703530579928894894692,  0.909167983090522269229438734328,
    0.903989293123443116151349840948,  0.898674465693953705702767820185,
    0.893224301195515213436237900169,  0.887639620402853823932787236117,
    0.881921264348354827511400344520,  0.876070094195406490200639382238,
    0.870086991108711238496198348003,  0.863972856121586696431791096984,
    0.857728610000272007063415458106,  0.851355193105265084518862295226,
    0.844853565249707116890931501985,  0.838224705554838078747081908659,
    0.831469612302545346693705141661,  0.824589302785025402009466688469,
    0.817584813151583822410373159073,  0.810457198252594990250941009435,
    0.803207531480645053889588780294,  0.795836904608883677347819229908,
    0.788346427626606449656776476331,  0.780737228572094599243769152963,
    0.773010453362737104399116105924,  0.765167265622459069618344074115,
    0.757208846506484678506865293457,  0.749136394523459481220584166294,
    0.740951125354959327928838774824,  0.732654271672413037741478092357,
    0.724247082951467113787202833919,  0.715730825283818705706551099865,
    1.000000000000000000000000000000,  0.998118112900149290211970765085,
    0.992479534598709856041409693717,  0.983105487431216396032596094301,
    0.970031253194544085260986321373,  0.953306040354193862107479162660,
    0.932992798834738845670244700159,  0.909167983090522269229438734328,
    0.881921264348354827511400344520,  0.851355193105265084518862295226,
    0.817584813151583822410373159073,  0.780737228572094599243769152963,
    0.740951125354959327928838774824,  0.698376249408973026611135992425,
    0.653172842953776866536941270169,  0.605511041404325545123299434636,
    0.555570233019602177648721408332,  0.503538383725717575423175276228,
    0.449611329654606595163102156221,  0.393992040061048154342415728024,
    0.336889853392220106620413844212,  0.278519689385053115238122245501,
    0.219101240156869797592875670489,  0.158858143333861417945129801410,
    0.098017140329560770162231619906,  0.036807222941358991308291592759,
    -0.024541228522912142406831037533, -0.085797312344439768949655444885,
    -0.146730474455361636909600520084, -0.207111376192218477054751701871,
    -0.266712757474898309872912705032, -0.325310292162262926218829761638,
    -0.382683432365089726268081449234, -0.438616238538527380974585412332,
    -0.492898192229783871365356162642, -0.545324988422046130764897498011,
    -0.595699304492433245883376002894, -0.643831542889791164085977470677,
    -0.689540544737066940506053924764, -0.732654271672412704674570704810,
    -0.773010453362737104399116105924, -0.810457198252594768206336084404,
    -0.844853565249707116890931501985, -0.876070094195406490200639382238,
    -0.903989293123443227173652303463, -0.928506080473215478221504781686,
    -0.949528180593036785772653729509, -0.966976471044852292635596313630,
    -0.980785280403230430579242238309, -0.990902635427779898691369453445,
    -0.997290456678690206970827603072, -0.999924701839144614012866441044,
    -0.998795456205172627051069866866, -0.993906970002355949489469821856,
    -0.985277642388941332640683867794, -0.972939952205560287801233698701,
    -0.956940335732209046426532950136, -0.937339011912574959772825877735,
    -0.914209755703530690951197357208, -0.887639620402853823932787236117,
    -0.857728610000272118085717920621, -0.824589302785025290987164225953,
    -0.788346427626606560679078938847, -0.749136394523459370198281703779,
    1.000000000000000000000000000000,  0.999322384588349654777061914501,
    0.997290456678690095948525140557,  0.993906970002355838467167359340,
    0.989176509964780903416681212548,  0.983105487431216396032596094301,
    0.975702130038528792077556772711,  0.966976471044852292635596313630,
    0.956940335732209046426532950136,  0.945607325380521390734145370516,
    0.932992798834738845670244700159,  0.919113851690057659382659949188,
    0.903989293123443116151349840948,  0.887639620402853823932787236117,
    0.870086991108711238496198348003,  0.851355193105265084518862295226,
    0.831469612302545346693705141661,  0.810457198252594990250941009435,
    0.788346427626606449656776476331,  0.765167265622459069618344074115,
    0.740951125354959327928838774824,  0.715730825283818705706551099865,
    0.689540544737066940506053924764,  0.662415777590171783728578702721,
    0.634393284163645487794269683945,  0.605511041404325545123299434636,
    0.575808191417845338655467912758,  0.545324988422046463831804885558,
    0.514102744193221661284098900069,  0.482183772079122829889996637576,
    0.449611329654606595163102156221,  0.416429560097637319060481786437,
    0.382683432365089837290383911750,  0.348418680249434564721866536274,
    0.313681740398891573118334008541,  0.278519689385053115238122245501,
    0.242980179903264037477583769942,  0.207111376192218588077054164387,
    0.170961888760301383705098032806,  0.134580708507126223238969942031,
    0.098017140329560770162231619906,  0.061320736302208654622258876543,
    0.024541228522912267306921307863,  -0.012271538285719823038744102917,
    -0.049067674327418007995671445087, -0.085797312344439768949655444885,
    -0.122410675199216167907678709525, -0.158858143333861306922827338894,
    -0.195090322016128220328212705681, -0.231058108280671192780175715598,
    -0.266712757474898309872912705032, -0.302005949319228139682280698253,
    -0.336889853392219995598111381696, -0.371317193951837543064442570540,
    -0.405241314004989749975038648699, -0.438616238538527380974585412332,
    -0.471396736825997642039709489836, -0.503538383725717353378570351197,
    -0.534997619887096931279302225448, -0.565731810783613120463542145444,
    -0.595699304492433245883376002894, -0.624859488142386121367621854006,
    -0.653172842953776422447731420107, -0.680600997795453022121137109934,
    1.000000000000000000000000000000,  0.996312612182777890268425835529,
    0.985277642388941221618381405278,  0.966976471044852292635596313630,
    0.941544065183020806308888950298,  0.909167983090522269229438734328,
    0.870086991108711238496198348003,  0.824589302785025402009466688469,
    0.773010453362737104399116105924,  0.715730825283818705706551099865,
    0.653172842953776866536941270169,  0.585797857456438864076631034550,
    0.514102744193221661284098900069,  0.438616238538527658530341568621,
    0.359895036534988277399094158682,  0.278519689385053115238122245501,
    0.195090322016128331350515168197,  0.110222207293883184275884445924,
    0.024541228522912267306921307863,  -0.061320736302208529722168606213,
    -0.146730474455361636909600520084, -0.231058108280671192780175715598,
    -0.313681740398891462096031546025, -0.393992040061048043320113265509,
    -0.471396736825997642039709489836, -0.545324988422046130764897498011,
    -0.615231590580626597208890871116, -0.680600997795453022121137109934,
    -0.740951125354958994861931387277, -0.795836904608883566325516767392,
    -0.844853565249707116890931501985, -0.887639620402853712910484773602,
    -0.923879532511286627460833642544, -0.953306040354193973129781625175,
    -0.975702130038528681055254310195, -0.990902635427779898691369453445,
    -0.998795456205172405006464941835, -0.999322384588349654777061914501,
    -0.992479534598709856041409693717, -0.978317370719627765751624792756,
    -0.956940335732209046426532950136, -0.928506080473215589243807244202,
    -0.893224301195515213436237900169, -0.851355193105265306563467220258,
    -0.803207531480645053889588780294, -0.749136394523459370198281703779,
    -0.689540544737067162550658849796, -0.624859488142386454434529241553,
    -0.555570233019602066626418945816, -0.482183772079122552334240481287,
    -0.405241314004990360597702192536, -0.325310292162263314796888380442,
    -0.242980179903264148499886232457, -0.158858143333861556723007879555,
    -0.073564563599667356919020733130, 0.012271538285720143962587158626,
    0.098017140329560090150629036998,  0.183039887955140617714633322066,
    0.266712757474898254361761473774,  0.348418680249434564721866536274,
    0.427555093430282195932079503109,  0.503538383725717686445477738744,
    0.575808191417844783543955600180,  0.643831542889791164085977470677};
__constant T table_sin_512[64 * 7] = {
    -0.000000000000000000000000000000, -0.049067674327418014934565348995,
    -0.098017140329560603628777926133, -0.146730474455361747931902982600,
    -0.195090322016128275839363936939, -0.242980179903263926455281307426,
    -0.290284677254462386564171083592, -0.336889853392220106620413844212,
    -0.382683432365089781779232680492, -0.427555093430282084909777040593,
    -0.471396736825997586528558258578, -0.514102744193221550261796437553,
    -0.555570233019602066626418945816, -0.595699304492433245883376002894,
    -0.634393284163645376771967221430, -0.671558954847018330092112137208,
    -0.707106781186547572737310929369, -0.740951125354959216906536312308,
    -0.773010453362737104399116105924, -0.803207531480644942867286317778,
    -0.831469612302545235671402679145, -0.857728610000272007063415458106,
    -0.881921264348354827511400344520, -0.903989293123443116151349840948,
    -0.923879532511286627460833642544, -0.941544065183020806308888950298,
    -0.956940335732209046426532950136, -0.970031253194544085260986321373,
    -0.980785280403230541601544700825, -0.989176509964780903416681212548,
    -0.995184726672196817709448168898, -0.998795456205172516028767404350,
    -1.000000000000000000000000000000, -0.998795456205172516028767404350,
    -0.995184726672196706687145706383, -0.989176509964781014438983675063,
    -0.980785280403230541601544700825, -0.970031253194544196283288783889,
    -0.956940335732209046426532950136, -0.941544065183020917331191412813,
    -0.923879532511286738483136105060, -0.903989293123443338195954765979,
    -0.881921264348354938533702807035, -0.857728610000272118085717920621,
    -0.831469612302545457716007604176, -0.803207531480645053889588780294,
    -0.773010453362737215421418568440, -0.740951125354959105884233849793,
    -0.707106781186547683759613391885, -0.671558954847018552136717062240,
    -0.634393284163645376771967221430, -0.595699304492433356905678465409,
    -0.555570233019602066626418945816, -0.514102744193221661284098900069,
    -0.471396736825997808573163183610, -0.427555093430282029398625809335,
    -0.382683432365089892801535143008, -0.336889853392220328665018769243,
    -0.290284677254462386564171083592, -0.242980179903264065233159385571,
    -0.195090322016128608906271324486, -0.146730474455361803443054213858,
    -0.098017140329560839551170658979, -0.049067674327417973301201925551,
    -0.000000000000000000000000000000, -0.024541228522912288123603019585,
    -0.049067674327418014934565348995, -0.073564563599667426307959772203,
    -0.098017140329560603628777926133, -0.122410675199216195663254325154,
    -0.146730474455361747931902982600, -0.170961888760301244927219954661,
    -0.195090322016128275839363936939, -0.219101240156869825348451286118,
    -0.242980179903263926455281307426, -0.266712757474898365384063936290,
    -0.290284677254462386564171083592, -0.313681740398891517607182777283,
    -0.336889853392220106620413844212, -0.359895036534988166376791696166,
    -0.382683432365089781779232680492, -0.405241314004989916508492342473,
    -0.427555093430282084909777040593, -0.449611329654606539651950924963,
    -0.471396736825997586528558258578, -0.492898192229783982387658625157,
    -0.514102744193221550261796437553, -0.534997619887097042301604687964,
    -0.555570233019602066626418945816, -0.575808191417845227633165450243,
    -0.595699304492433245883376002894, -0.615231590580626708231193333631,
    -0.634393284163645376771967221430, -0.653172842953776755514638807654,
    -0.671558954847018330092112137208, -0.689540544737066940506053924764,
    -0.707106781186547572737310929369, -0.724247082951467002764900371403,
    -0.740951125354959216906536312308, -0.757208846506484678506865293457,
    -0.773010453362737104399116105924, -0.788346427626606338634474013816,
    -0.803207531480644942867286317778, -0.817584813151583711388070696557,
    -0.831469612302545235671402679145, -0.844853565249707005868629039469,
    -0.857728610000272007063415458106, -0.870086991108711238496198348003,
    -0.881921264348354827511400344520, -0.893224301195515213436237900169,
    -0.903989293123443116151349840948, -0.914209755703530579928894894692,
    -0.923879532511286627460833642544, -0.932992798834738845670244700159,
    -0.941544065183020806308888950298, -0.949528180593036785772653729509,
    -0.956940335732209046426532950136, -0.963776065795440062267118719319,
    -0.970031253194544085260986321373, -0.975702130038528792077556772711,
    -0.980785280403230541601544700825, -0.985277642388941221618381405278,
    -0.989176509964780903416681212548, -0.992479534598709856041409693717,
    -0.995184726672196817709448168898, -0.997290456678690095948525140557,
    -0.998795456205172516028767404350, -0.999698818696204360989554515982,
    -0.000000000000000000000000000000, -0.073564563599667426307959772203,
    -0.146730474455361747931902982600, -0.219101240156869825348451286118,
    -0.290284677254462386564171083592, -0.359895036534988166376791696166,
    -0.427555093430282084909777040593, -0.492898192229783982387658625157,
    -0.555570233019602066626418945816, -0.615231590580626708231193333631,
    -0.671558954847018330092112137208, -0.724247082951467002764900371403,
    -0.773010453362737104399116105924, -0.817584813151583711388070696557,
    -0.857728610000272007063415458106, -0.893224301195515213436237900169,
    -0.923879532511286627460833642544, -0.949528180593036785772653729509,
    -0.970031253194544085260986321373, -0.985277642388941221618381405278,
    -0.995184726672196817709448168898, -0.999698818696204360989554515982,
    -0.998795456205172516028767404350, -0.992479534598709856041409693717,
    -0.980785280403230541601544700825, -0.963776065795440062267118719319,
    -0.941544065183020917331191412813, -0.914209755703530690951197357208,
    -0.881921264348354938533702807035, -0.844853565249707227913233964500,
    -0.803207531480645053889588780294, -0.757208846506484900551470218488,
    -0.707106781186547683759613391885, -0.653172842953776644492336345138,
    -0.595699304492433356905678465409, -0.534997619887097042301604687964,
    -0.471396736825997808573163183610, -0.405241314004989916508492342473,
    -0.336889853392220328665018769243, -0.266712757474898476406366398805,
    -0.195090322016128608906271324486, -0.122410675199216348318920211113,
    -0.049067674327417973301201925551, 0.024541228522912083426232854322,
    0.098017140329560589750990118318,  0.170961888760300995127039414001,
    0.242980179903263870944130076168,  0.313681740398891240051426620994,
    0.382683432365089670756930217976,  0.449611329654606650674253387479,
    0.514102744193221550261796437553,  0.575808191417845227633165450243,
    0.634393284163645265749664758914,  0.689540544737066940506053924764,
    0.740951125354958994861931387277,  0.788346427626606005567566626269,
    0.831469612302545346693705141661,  0.870086991108711127473895885487,
    0.903989293123443005129047378432,  0.932992798834738845670244700159,
    0.956940335732208935404230487620,  0.975702130038528681055254310195,
    0.989176509964780792394378750032,  0.997290456678690095948525140557,
    -0.000000000000000000000000000000, -0.012271538285719925387429185548,
    -0.024541228522912288123603019585, -0.036807222941358831713731802893,
    -0.049067674327418014934565348995, -0.061320736302208578294425933564,
    -0.073564563599667426307959772203, -0.085797312344439893849745715215,
    -0.098017140329560603628777926133, -0.110222207293883059375794175594,
    -0.122410675199216195663254325154, -0.134580708507126167727818710773,
    -0.146730474455361747931902982600, -0.158858143333861473456281032668,
    -0.170961888760301244927219954661, -0.183039887955140950781540709613,
    -0.195090322016128275839363936939, -0.207111376192218588077054164387,
    -0.219101240156869825348451286118, -0.231058108280671137269024484340,
    -0.242980179903263926455281307426, -0.254865659604514627201155008152,
    -0.266712757474898365384063936290, -0.278519689385053115238122245501,
    -0.290284677254462386564171083592, -0.302005949319228139682280698253,
    -0.313681740398891517607182777283, -0.325310292162262926218829761638,
    -0.336889853392220106620413844212, -0.348418680249434620233017767532,
    -0.359895036534988166376791696166, -0.371317193951837543064442570540,
    -0.382683432365089781779232680492, -0.393992040061048154342415728024,
    -0.405241314004989916508492342473, -0.416429560097637152527028092663,
    -0.427555093430282084909777040593, -0.438616238538527603019190337363,
    -0.449611329654606539651950924963, -0.460538710958239949633252763306,
    -0.471396736825997586528558258578, -0.482183772079122663356542943802,
    -0.492898192229783982387658625157, -0.503538383725717464400872813712,
    -0.514102744193221550261796437553, -0.524589682678468838261665041500,
    -0.534997619887097042301604687964, -0.545324988422046352809502423042,
    -0.555570233019602066626418945816, -0.565731810783613009441239682928,
    -0.575808191417845227633165450243, -0.585797857456438753054328572034,
    -0.595699304492433245883376002894, -0.605511041404325434100996972120,
    -0.615231590580626708231193333631, -0.624859488142386343412226779037,
    -0.634393284163645376771967221430, -0.643831542889791386130582395708,
    -0.653172842953776755514638807654, -0.662415777590171672706276240206,
    -0.671558954847018330092112137208, -0.680600997795453022121137109934,
    -0.689540544737066940506053924764, -0.698376249408972915588833529910,
    -0.000000000000000000000000000000, -0.061320736302208578294425933564,
    -0.122410675199216195663254325154, -0.183039887955140950781540709613,
    -0.242980179903263926455281307426, -0.302005949319228139682280698253,
    -0.359895036534988166376791696166, -0.416429560097637152527028092663,
    -0.471396736825997586528558258578, -0.524589682678468838261665041500,
    -0.575808191417845227633165450243, -0.624859488142386343412226779037,
    -0.671558954847018330092112137208, -0.715730825283818705706551099865,
    -0.757208846506484678506865293457, -0.795836904608883677347819229908,
    -0.831469612302545235671402679145, -0.863972856121586696431791096984,
    -0.893224301195515213436237900169, -0.919113851690057659382659949188,
    -0.941544065183020806308888950298, -0.960430519415566008589735247369,
    -0.975702130038528792077556772711, -0.987301418157858323709774595045,
    -0.995184726672196817709448168898, -0.999322384588349654777061914501,
    -0.999698818696204360989554515982, -0.996312612182777890268425835529,
    -0.989176509964781014438983675063, -0.978317370719627876773927255272,
    -0.963776065795440062267118719319, -0.945607325380521501756447833031,
    -0.923879532511286738483136105060, -0.898674465693953816725070282700,
    -0.870086991108711460540803273034, -0.838224705554838189769384371175,
    -0.803207531480645053889588780294, -0.765167265622459180640646536631,
    -0.724247082951467002764900371403, -0.680600997795453244165742034966,
    -0.634393284163645376771967221430, -0.585797857456438975098933497065,
    -0.534997619887097042301604687964, -0.482183772079122829889996637576,
    -0.427555093430282029398625809335, -0.371317193951837709597896264313,
    -0.313681740398891406584880314767, -0.254865659604514738223457470667,
    -0.195090322016128608906271324486, -0.134580708507126278750121173289,
    -0.073564563599667745497079351935, -0.012271538285720006919432556458,
    0.049067674327417723501021384891,  0.110222207293883003864642944336,
    0.170961888760300995127039414001,  0.231058108280671137269024484340,
    0.290284677254462164519566158560,  0.348418680249434620233017767532,
    0.405241314004989694463887417442,  0.460538710958240005144403994564,
    0.514102744193221550261796437553,  0.565731810783613120463542145444,
    0.615231590580626597208890871116,  0.662415777590171783728578702721,
    -0.000000000000000000000000000000, -0.036807222941358831713731802893,
    -0.073564563599667426307959772203, -0.110222207293883059375794175594,
    -0.146730474455361747931902982600, -0.183039887955140950781540709613,
    -0.219101240156869825348451286118, -0.254865659604514627201155008152,
    -0.290284677254462386564171083592, -0.325310292162262926218829761638,
    -0.359895036534988166376791696166, -0.393992040061048154342415728024,
    -0.427555093430282084909777040593, -0.460538710958239949633252763306,
    -0.492898192229783982387658625157, -0.524589682678468838261665041500,
    -0.555570233019602066626418945816, -0.585797857456438753054328572034,
    -0.615231590580626708231193333631, -0.643831542889791386130582395708,
    -0.671558954847018330092112137208, -0.698376249408972915588833529910,
    -0.724247082951467002764900371403, -0.749136394523459370198281703779,
    -0.773010453362737104399116105924, -0.795836904608883677347819229908,
    -0.817584813151583711388070696557, -0.838224705554838078747081908659,
    -0.857728610000272007063415458106, -0.876070094195406490200639382238,
    -0.893224301195515213436237900169, -0.909167983090522158207136271812,
    -0.923879532511286627460833642544, -0.937339011912574959772825877735,
    -0.949528180593036785772653729509, -0.960430519415566008589735247369,
    -0.970031253194544085260986321373, -0.978317370719627765751624792756,
    -0.985277642388941221618381405278, -0.990902635427779898691369453445,
    -0.995184726672196817709448168898, -0.998118112900149290211970765085,
    -0.999698818696204360989554515982, -0.999924701839144725035168903560,
    -0.998795456205172516028767404350, -0.996312612182777890268425835529,
    -0.992479534598709856041409693717, -0.987301418157858434732077057561,
    -0.980785280403230541601544700825, -0.972939952205560287801233698701,
    -0.963776065795440062267118719319, -0.953306040354193973129781625175,
    -0.941544065183020917331191412813, -0.928506080473215589243807244202,
    -0.914209755703530690951197357208, -0.898674465693953816725070282700,
    -0.881921264348354938533702807035, -0.863972856121586807454093559500,
    -0.844853565249707227913233964500, -0.824589302785025290987164225953,
    -0.803207531480645053889588780294, -0.780737228572094710266071615479,
    -0.757208846506484900551470218488, -0.732654271672412926719175629842,
    -0.000000000000000000000000000000, -0.085797312344439893849745715215,
    -0.170961888760301244927219954661, -0.254865659604514627201155008152,
    -0.336889853392220106620413844212, -0.416429560097637152527028092663,
    -0.492898192229783982387658625157, -0.565731810783613009441239682928,
    -0.634393284163645376771967221430, -0.698376249408972915588833529910,
    -0.757208846506484678506865293457, -0.810457198252594879228638546920,
    -0.857728610000272007063415458106, -0.898674465693953705702767820185,
    -0.932992798834738845670244700159, -0.960430519415566008589735247369,
    -0.980785280403230541601544700825, -0.993906970002355838467167359340,
    -0.999698818696204360989554515982, -0.998118112900149179189668302570,
    -0.989176509964781014438983675063, -0.972939952205560287801233698701,
    -0.949528180593036785772653729509, -0.919113851690057770404962411703,
    -0.881921264348354938533702807035, -0.838224705554838189769384371175,
    -0.788346427626606449656776476331, -0.732654271672412926719175629842,
    -0.671558954847018552136717062240, -0.605511041404325545123299434636,
    -0.534997619887097042301604687964, -0.460538710958240227189008919595,
    -0.382683432365089892801535143008, -0.302005949319228084171129466995,
    -0.219101240156870075148631826778, -0.134580708507126278750121173289,
    -0.049067674327417973301201925551, 0.036807222941358581913551262232,
    0.122410675199216098518739670453,  0.207111376192218643588205395645,
    0.290284677254462164519566158560,  0.371317193951837487553291339282,
    0.449611329654606650674253387479,  0.524589682678468616217060116469,
    0.595699304492433245883376002894,  0.662415777590171783728578702721,
    0.724247082951466891742597908888,  0.780737228572094599243769152963,
    0.831469612302545346693705141661,  0.876070094195406601222941844753,
    0.914209755703530246861987507145,  0.945607325380521168689540445484,
    0.970031253194544085260986321373,  0.987301418157858212687472132529,
    0.997290456678690095948525140557,  0.999924701839144725035168903560,
    0.995184726672196817709448168898,  0.983105487431216396032596094301,
    0.963776065795440062267118719319,  0.937339011912574959772825877735,
    0.903989293123443116151349840948,  0.863972856121586474387186171953,
    0.817584813151584044454978084104,  0.765167265622459291662948999146};
#define twiddle8(a, i, n)                                                      \
  {                                                                            \
    int reversed8[] = {0, 4, 2, 6, 1, 5, 3, 7};                                \
    for (int j = 1; j < 8; j++) {                                              \
      a[j] = cmplx_mul(a[j], exp_i((-2 * M_PI * reversed8[j] / (n)) * (i)));   \
    }                                                                          \
  }
#define twiddle8_512(a, tid)                                                   \
  {                                                                            \
    int reversed8[] = {0, 4, 2, 6, 1, 5, 3, 7};                                \
    for (int j = 1; j < 8; j++) {                                              \
      const T2 te = (T2)(table_cos_512[(j - 1) * 64 + tid],                    \
                         table_sin_512[(j - 1) * 64 + tid]);                   \
      a[j] = cmplx_mul(a[j], te);                                              \
    }                                                                          \
  }
#define twiddle8_64(a, tid)                                                    \
  {                                                                            \
    int reversed8[] = {0, 4, 2, 6, 1, 5, 3, 7};                                \
    for (int j = 1; j < 8; j++) {                                              \
      const T2 te = (T2)(table_cos_64[(j - 1) * 64 + tid],                     \
                         table_sin_64[(j - 1) * 64 + tid]);                    \
      a[j] = cmplx_mul(a[j], te);                                              \
    }                                                                          \
  }
#define FFT2(a0, a1)                                                           \
  {                                                                            \
    T2 c0 = *a0;                                                               \
    *a0 = cmplx_add(c0, *a1);                                                  \
    *a1 = cmplx_sub(c0, *a1);                                                  \
  }
#define FFT4(a0, a1, a2, a3)                                                   \
  {                                                                            \
    FFT2(a0, a2);                                                              \
    FFT2(a1, a3);                                                              \
    *a3 = cmplx_mul(*a3, exp_1_4);                                             \
    FFT2(a0, a1);                                                              \
    FFT2(a2, a3);                                                              \
  }
#define FFT8(a)                                                                \
  {                                                                            \
    FFT2(&a[0], &a[4]);                                                        \
    FFT2(&a[1], &a[5]);                                                        \
    FFT2(&a[2], &a[6]);                                                        \
    FFT2(&a[3], &a[7]);                                                        \
                                                                               \
    a[5] = cm_fl_mul(cmplx_mul(a[5], exp_1_8), M_SQRT1_2);                     \
    a[6] = cmplx_mul(a[6], exp_1_4);                                           \
    a[7] = cm_fl_mul(cmplx_mul(a[7], exp_3_8), M_SQRT1_2);                     \
                                                                               \
    FFT4(&a[0], &a[1], &a[2], &a[3]);                                          \
    FFT4(&a[4], &a[5], &a[6], &a[7]);                                          \
  }
#define itwiddle8(a, i, n)                                                     \
  {                                                                            \
    int reversed8[] = {0, 4, 2, 6, 1, 5, 3, 7};                                \
    for (int j = 1; j < 8; j++)                                                \
      a[j] = cmplx_mul(a[j], exp_i((2 * M_PI * reversed8[j] / (n)) * (i)));    \
  }
#define itwiddle8_512(a, tid)                                                  \
  {                                                                            \
    int reversed8[] = {0, 4, 2, 6, 1, 5, 3, 7};                                \
    for (int j = 1; j < 8; j++) {                                              \
      const T2 te = (T2)(table_cos_512[(j - 1) * 64 + tid],                    \
                         -table_sin_512[(j - 1) * 64 + tid]);                  \
      a[j] = cmplx_mul(a[j], te);                                              \
    }                                                                          \
  }
#define itwiddle8_64(a, tid)                                                   \
  {                                                                            \
    int reversed8[] = {0, 4, 2, 6, 1, 5, 3, 7};                                \
    for (int j = 1; j < 8; j++) {                                              \
      const T2 te = (T2)(table_cos_64[(j - 1) * 64 + tid],                     \
                         -table_sin_64[(j - 1) * 64 + tid]);                   \
      a[j] = cmplx_mul(a[j], te);                                              \
    }                                                                          \
  }
#define IFFT2 FFT2
#define IFFT4(a0, a1, a2, a3)                                                  \
  {                                                                            \
    IFFT2(a0, a2);                                                             \
    IFFT2(a1, a3);                                                             \
    *a3 = cmplx_mul(*a3, iexp_1_4);                                            \
    IFFT2(a0, a1);                                                             \
    IFFT2(a2, a3);                                                             \
  }
#define IFFT8(a)                                                               \
  {                                                                            \
    IFFT2(&a[0], &a[4]);                                                       \
    IFFT2(&a[1], &a[5]);                                                       \
    IFFT2(&a[2], &a[6]);                                                       \
    IFFT2(&a[3], &a[7]);                                                       \
                                                                               \
    a[5] = cm_fl_mul(cmplx_mul(a[5], iexp_1_8), M_SQRT1_2);                    \
    a[6] = cmplx_mul(a[6], iexp_1_4);                                          \
    a[7] = cm_fl_mul(cmplx_mul(a[7], iexp_3_8), M_SQRT1_2);                    \
                                                                               \
    IFFT4(&a[0], &a[1], &a[2], &a[3]);                                         \
    IFFT4(&a[4], &a[5], &a[6], &a[7]);                                         \
  }
///////////////////////////////////////////
__kernel void fft1D_512(__global T2 *work) {
  int tid = get_local_id(0);
  int blockIdx = (int)get_group_id(0) * 512 + tid;
  int hi = tid >> 3;
  int lo = tid & 7;
  T2 data[8];
  __local T smem[8 * 8 * 9];
  // starting index of data to/from global memory
  // work = work + blockIdx;
  // out = out + blockIdx;
  globalLoads8_offset(data, work, blockIdx, 64); // coalesced global reads
  FFT8(data);
  //  twiddle8( data, tid, 512 );
  twiddle8_512(data, tid);
  transpose(data, &smem[hi * 8 + lo], 66, &smem[lo * 66 + hi], 8, 0xf);
  FFT8(data);
  //  twiddle8( data, hi, 64 );
  twiddle8_64(data, tid);
  transpose(data, &smem[hi * 8 + lo], 8 * 9, &smem[hi * 8 * 9 + lo], 8, 0xE);
  FFT8(data);
  globalStores8_offset(data, work, blockIdx, 64);
}
__kernel void ifft1D_512(__global T2 *work) {
  int i;
  int tid = get_local_id(0);
  int blockIdx = get_group_id(0) * 512 + tid;
  int hi = tid >> 3;
  int lo = tid & 7;
  T2 data[8];
  __local T smem[8 * 8 * 9];
  // starting index of data to/from global memory
  // work = work + blockIdx;
  globalLoads8_offset(data, work, blockIdx, 64); // coalesced global reads
  // Inject an artificial error for testing the sensitivity of FFT
  // if( blockIdx == 0 ){ data[6] *= 1.001; }
  IFFT8(data);
  //  itwiddle8( data, tid, 512 );
  itwiddle8_512(data, tid);
  transpose(data, &smem[hi * 8 + lo], 66, &smem[lo * 66 + hi], 8, 0xf);
  IFFT8(data);
  //  itwiddle8( data, hi, 64 );
  itwiddle8_64(data, tid);
  transpose(data, &smem[hi * 8 + lo], 8 * 9, &smem[hi * 8 * 9 + lo], 8, 0xE);
  IFFT8(data);
  for (i = 0; i < 8; i++) {
    data[i].x = data[i].x / 512.0f;
    data[i].y = data[i].y / 512.0f;
  }
  globalStores8_offset(data, work, blockIdx, 64);
}
__kernel void chk1D_512(__global T2 *work, int half_n_cmplx,
                        __global int *fail) {
  int i, tid = get_local_id(0);
  int blockIdx = get_group_id(0) * 512 + tid;
  T2 a[8], b[8];
  work = work + blockIdx;
  for (i = 0; i < 8; i++) {
    a[i] = work[i * 64];
  }
  for (i = 0; i < 8; i++) {
    b[i] = work[half_n_cmplx + i * 64];
  }
  for (i = 0; i < 8; i++) {
    if (a[i].x != b[i].x || a[i].y != b[i].y) {
      *fail = 1;
    }
  }
}
