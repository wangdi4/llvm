/*
 * Part of the tests that check different LLVM instructions on different argument
 * types and different argument sources.
 *
 * Tests the LLVM extractelement instruction when it recieves as input short4 arguments
 * produced by previous instructions.
 * This instruction is NOT vectorizable.
 *
 * @param in
 * 		The input array.
 * @param out
 * 		The output array.
 *
 */
__kernel void
extractelement_short4 ( __global const float *in,
		__global float *out)
{
	int gid = get_global_id(0);
	short x =  (short)(fast_normalize(in[gid]));
	short y =  (short)(step(in[gid], in[gid] * 2));
	short z = x + y / 3;
	short w = abs(x) + mad_hi(z, x, y);
	short4 tmp = (x, y, z, w);
	tmp = clz(tmp);
	out[gid] = tmp.x + tmp.y * tmp.z - tmp.w;
}
