__kernel void wia_01_dotproduct_rn_un( __global const double2 *in,
		__global double2 *out)
{
	int gid = get_global_id(0);
	double4 x=(double4) (in[1].s0,in[2].s1,in[3].s0,4.), y=(in[gid].s0,in[gid].s1*2+1,in[gid].s0,in[gid].s1*5+1); //un*rnd
	int i;
	double z=0;
	
	
	for (i=0;i<12000;i++)
	{
		if( z>12)  //in
		{
			x=x+1; 
			y=y-2; 
			z=dot(x,x);   //un*un
			i=i+2+z;
		}	
	
	out[gid]+=z+i;
	
	
	}	
	for (i=1000;i>0;i-=2)
	{
	
		z+=dot(y,y); //rnd*rnd
		
		out[gid]-=z;
	}
	
	out[gid]+=dot(x,y); // rnd*un
	
	
	
}