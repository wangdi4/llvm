__kernel void
aatomic_func02
( __global  int *in,
		__global float *out)
{
	int gid = get_global_id(0);
	int i;
	float sum2=0;
	int rez1,rez2,rez3,rez4,rez5;
	int j;	
	//printf("\n gid=%d in[gid]=%d in[gid+33]=%d\n",gid,in[gid],in[gid+33]);
		for (j=0;j<2;j++)
		{
			rez2=atomic_add(&in[gid],1);
			rez3=atomic_sub(&in[gid],gid);	
			if (rez2+rez3>0)
			{					
				rez5=atomic_xchg(&in[gid],gid);
			}						
			sum2=sum2+rez2+rez3+atomic_xchg(&in[gid],1)-rez5;	 		
		}		
	out[gid] =	sum2;
}	