; NOTE: Assertions have been autogenerated by utils/update_llc_test_checks.py
; REQUIRES: intel_feature_isa_avx256p
; RUN: llc < %s | FileCheck %s --check-prefixes=CHECK

target datalayout = "e-m:e-p270:32:32-p271:32:32-p272:64:64-i64:64-f80:128-n8:16:32:64-S128"
target triple = "x86_64-unknown-linux-gnu"

define void @bar(<16 x i32> %arg0, <16 x i32> %arg1, ptr %arg2) #0 {
; CHECK-LABEL: bar:
; CHECK:       # %bb.0:
; CHECK-NEXT:    vpcmpnleud %zmm0, %zmm1, %k1
; CHECK-NEXT:    vpternlogd $255, %zmm0, %zmm0, %zmm0 {%k1} {z}
; CHECK-NEXT:    vpsrld $31, %zmm0, %zmm0
; CHECK-NEXT:    vmovdqu64 %zmm0, (%rdi)
; CHECK-NEXT:    vzeroupper
; CHECK-NEXT:    retq
  %1 = icmp ugt <16 x i32> %arg1, %arg0
  %2 = zext <16 x i1> %1 to <16 x i32>
  store <16 x i32> %2, ptr %arg2, align 1
  ret void
}

attributes #0 = { nounwind "target-features"="+avx256p,+avx512f" }
