; This module is used by opaque-type-handling.ll

target datalayout = "e-p:32:32:32-i1:8:8-i8:8:8-i16:16:16-i32:32:32-i64:64:64-f32:32:32-f64:64:64-f80:128:128-v64:64:64-v128:128:128-a0:0:64-f80:32:32-n8:16:32"
target triple = "i686-pc-win32"

define ptr @load(ptr %prid) !kernel_arg_base_type !0 !arg_type_null_val !1 {
entry:
  %ret = load ptr, ptr %prid, align 8
  ret ptr %ret
}

; Function Attrs: nounwind
define ptr @callee(ptr addrspace(1) nocapture %p, ptr %prid, i32 %packet) #0 !kernel_arg_base_type !2 !arg_type_null_val !3 {
entry:
  %rid = call ptr @load(ptr %prid)
  %conv = sext i32 %packet to i64
  %astype = inttoptr i64 %conv to ptr
  %null = bitcast ptr null to ptr
  %cmp = icmp slt ptr %rid, %null
  br i1 %cmp, label %if.end, label %if.then

if.then:                                          ; preds = %entry
  %0 = addrspacecast ptr addrspace(1) %p to ptr
  store i32 %packet, ptr %0, align 4
  br label %if.end

if.end:                                           ; preds = %if.then, %entry
  ret ptr %astype
}

attributes #0 = { nounwind }

!0 = !{!"reserve_id_t*"}
!1 = !{ptr null}
!2 = !{!"int", !"reserve_id_t*", !"int"}
!3 = !{target("spirv.Pipe", 1) zeroinitializer, ptr null, i32 0}
