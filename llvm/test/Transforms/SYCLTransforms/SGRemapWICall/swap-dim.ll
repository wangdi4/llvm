; NOTE: Assertions have been autogenerated by utils/update_test_checks.py
; RUN: opt --passes=sycl-kernel-sg-remap-wi-call -sycl-sg-construction-mode=2 -S %s | FileCheck %s
; RUN: opt --passes=sycl-kernel-sg-remap-wi-call -sycl-sg-construction-mode=2 -enable-debugify -disable-output -S %s 2>&1 | FileCheck -check-prefix=DEBUGIFY %s

define void @gid() {
; CHECK-LABEL: @gid(
; CHECK-SAME: !sg_construction_mode ![[#MD:]]
; CHECK-NEXT:  entry:
; CHECK-NEXT:    [[SWAPPED_GID0:%.*]] = call i64 @_Z13get_global_idj(i32 2)
; CHECK-NEXT:    [[GID1:%.*]] = call i64 @_Z13get_global_idj(i32 1)
; CHECK-NEXT:    [[SWAPPED_GID2:%.*]] = call i64 @_Z13get_global_idj(i32 0)
; CHECK-NEXT:    ret void
;
entry:
  %gid0 = call i64 @_Z13get_global_idj(i32 0)
  %gid1 = call i64 @_Z13get_global_idj(i32 1)
  %gid2 = call i64 @_Z13get_global_idj(i32 2)
  ret void
}

define void @lid() {
; CHECK-LABEL: @lid(
; CHECK-SAME: !sg_construction_mode ![[#MD]]
; CHECK-NEXT:  entry:
; CHECK-NEXT:    [[SWAPPED_LID0:%.*]] = call i64 @_Z12get_local_idj(i32 2)
; CHECK-NEXT:    [[LID1:%.*]] = call i64 @_Z12get_local_idj(i32 1)
; CHECK-NEXT:    [[SWAPPED_LID2:%.*]] = call i64 @_Z12get_local_idj(i32 0)
; CHECK-NEXT:    ret void
;
entry:
  %lid0 = call i64 @_Z12get_local_idj(i32 0)
  %lid1 = call i64 @_Z12get_local_idj(i32 1)
  %lid2 = call i64 @_Z12get_local_idj(i32 2)
  ret void
}

define void @groupid() {
; CHECK-LABEL: @groupid(
; CHECK-SAME: !sg_construction_mode ![[#MD]]
; CHECK-NEXT:  entry:
; CHECK-NEXT:    [[SWAPPED_GROUPID0:%.*]] = call i64 @_Z12get_group_idj(i32 2)
; CHECK-NEXT:    [[GROUPID1:%.*]] = call i64 @_Z12get_group_idj(i32 1)
; CHECK-NEXT:    [[SWAPPED_GROUPID2:%.*]] = call i64 @_Z12get_group_idj(i32 0)
; CHECK-NEXT:    ret void
;
entry:
  %groupid0 = call i64 @_Z12get_group_idj(i32 0)
  %groupid1 = call i64 @_Z12get_group_idj(i32 1)
  %groupid2 = call i64 @_Z12get_group_idj(i32 2)
  ret void
}

declare i64 @_Z13get_global_idj(i32 %x)
declare i64 @_Z12get_local_idj(i32 %x)
declare i64 @_Z12get_group_idj(i32 %x)

!sycl.kernels = !{!0}

!0 = !{void ()* @gid, void ()* @lid, void ()* @groupid}

; CHECK: ![[#MD]] = !{i32 2}

; DEBUGIFY-NOT: WARNING
