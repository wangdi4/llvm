; NOTE: Assertions have been autogenerated by utils/update_test_checks.py
; RUN: opt --passes=sycl-kernel-sg-remap-wi-call -sycl-sg-construction-mode=linear -S %s | FileCheck %s
; RUN: opt --passes=sycl-kernel-sg-remap-wi-call -sycl-sg-construction-mode=0 -S %s | FileCheck -check-prefix=CHECK-DEFAULT %s
; RUN: opt --passes=sycl-kernel-sg-remap-wi-call -sycl-sg-construction-mode=1 -S %s | FileCheck %s
; RUN: opt --passes=sycl-kernel-sg-remap-wi-call -sycl-sg-construction-mode=2 -S %s | FileCheck %s
; RUN: opt --passes=sycl-kernel-sg-remap-wi-call -sycl-sg-construction-mode=linear -enable-debugify -disable-output -S %s 2>&1 | FileCheck -check-prefix=DEBUGIFY %s
; RUN: opt --passes=sycl-kernel-sg-remap-wi-call -sycl-sg-construction-mode=0 -enable-debugify -disable-output -S %s 2>&1 | FileCheck -check-prefix=DEBUGIFY %s
; RUN: opt --passes=sycl-kernel-sg-remap-wi-call -sycl-sg-construction-mode=1 -enable-debugify -disable-output -S %s 2>&1 | FileCheck -check-prefix=DEBUGIFY %s
; RUN: opt --passes=sycl-kernel-sg-remap-wi-call -sycl-sg-construction-mode=2 -enable-debugify -disable-output -S %s 2>&1 | FileCheck -check-prefix=DEBUGIFY %s

define void @gsize() {
; CHECK-LABEL: @gsize(
; CHECK-SAME: !sg_construction_mode
; CHECK-NEXT:  entry:
; CHECK-NEXT:    [[GID0:%.*]] = call i64 @user._Z15get_global_sizej(i32 0)
; CHECK-NEXT:    [[GID1:%.*]] = call i64 @user._Z15get_global_sizej(i32 1)
; CHECK-NEXT:    [[GID2:%.*]] = call i64 @user._Z15get_global_sizej(i32 2)
; CHECK-NEXT:    ret void
;
; CHECK-DEFAULT-LABEL: @gsize(
; CHECK-DEFAULT-NOT: !sg_construction_mode
; CHECK-DEFAULT-NEXT:  entry:
; CHECK-DEFAULT-NEXT:    [[GID0:%.*]] = call i64 @_Z15get_global_sizej(i32 0)
; CHECK-DEFAULT-NEXT:    [[GID1:%.*]] = call i64 @_Z15get_global_sizej(i32 1)
; CHECK-DEFAULT-NEXT:    [[GID2:%.*]] = call i64 @_Z15get_global_sizej(i32 2)
; CHECK-DEFAULT-NEXT:    ret void
;
entry:
  %gid0 = call i64 @_Z15get_global_sizej(i32 0)
  %gid1 = call i64 @_Z15get_global_sizej(i32 1)
  %gid2 = call i64 @_Z15get_global_sizej(i32 2)
  ret void
}

define void @lsize() {
; CHECK-LABEL: @lsize(
; CHECK-SAME: !sg_construction_mode
; CHECK-NEXT:  entry:
; CHECK-NEXT:    [[LID0:%.*]] = call i64 @user._Z14get_local_sizej(i32 0)
; CHECK-NEXT:    [[LID1:%.*]] = call i64 @user._Z14get_local_sizej(i32 1)
; CHECK-NEXT:    [[LID2:%.*]] = call i64 @user._Z14get_local_sizej(i32 2)
; CHECK-NEXT:    ret void
;
; CHECK-DEFAULT-LABEL: @lsize(
; CHECK-DEFAULT-NOT: !sg_construction_mode
; CHECK-DEFAULT-NEXT:  entry:
; CHECK-DEFAULT-NEXT:    [[LID0:%.*]] = call i64 @_Z14get_local_sizej(i32 0)
; CHECK-DEFAULT-NEXT:    [[LID1:%.*]] = call i64 @_Z14get_local_sizej(i32 1)
; CHECK-DEFAULT-NEXT:    [[LID2:%.*]] = call i64 @_Z14get_local_sizej(i32 2)
; CHECK-DEFAULT-NEXT:    ret void
;
entry:
  %lid0 = call i64 @_Z14get_local_sizej(i32 0)
  %lid1 = call i64 @_Z14get_local_sizej(i32 1)
  %lid2 = call i64 @_Z14get_local_sizej(i32 2)
  ret void
}

define void @enq_lsize() {
; CHECK-LABEL: @enq_lsize(
; CHECK-SAME: !sg_construction_mode
; CHECK-NEXT:  entry:
; CHECK-NEXT:    [[LID0:%.*]] = call i64 @user._Z23get_enqueued_local_sizej(i32 0)
; CHECK-NEXT:    [[LID1:%.*]] = call i64 @user._Z23get_enqueued_local_sizej(i32 1)
; CHECK-NEXT:    [[LID2:%.*]] = call i64 @user._Z23get_enqueued_local_sizej(i32 2)
; CHECK-NEXT:    ret void
;
; CHECK-DEFAULT-LABEL: @enq_lsize(
; CHECK-DEFAULT-NOT: !sg_construction_mode
; CHECK-DEFAULT-NEXT:  entry:
; CHECK-DEFAULT-NEXT:    [[LID0:%.*]] = call i64 @_Z23get_enqueued_local_sizej(i32 0)
; CHECK-DEFAULT-NEXT:    [[LID1:%.*]] = call i64 @_Z23get_enqueued_local_sizej(i32 1)
; CHECK-DEFAULT-NEXT:    [[LID2:%.*]] = call i64 @_Z23get_enqueued_local_sizej(i32 2)
; CHECK-DEFAULT-NEXT:    ret void
;
entry:
  %lid0 = call i64 @_Z23get_enqueued_local_sizej(i32 0)
  %lid1 = call i64 @_Z23get_enqueued_local_sizej(i32 1)
  %lid2 = call i64 @_Z23get_enqueued_local_sizej(i32 2)
  ret void
}

define void @groupsize() {
; CHECK-LABEL: @groupsize(
; CHECK-SAME: !sg_construction_mode
; CHECK-NEXT:  entry:
; CHECK-NEXT:    [[GROUPID0:%.*]] = call i64 @user._Z14get_num_groupsj(i32 0)
; CHECK-NEXT:    [[GROUPID1:%.*]] = call i64 @user._Z14get_num_groupsj(i32 1)
; CHECK-NEXT:    [[GROUPID2:%.*]] = call i64 @user._Z14get_num_groupsj(i32 2)
; CHECK-NEXT:    ret void
;
; CHECK-DEFAULT-LABEL: @groupsize(
; CHECK-DEFAULT-NOT: !sg_construction_mode
; CHECK-DEFAULT-NEXT:  entry:
; CHECK-DEFAULT-NEXT:    [[GROUPID0:%.*]] = call i64 @_Z14get_num_groupsj(i32 0)
; CHECK-DEFAULT-NEXT:    [[GROUPID1:%.*]] = call i64 @_Z14get_num_groupsj(i32 1)
; CHECK-DEFAULT-NEXT:    [[GROUPID2:%.*]] = call i64 @_Z14get_num_groupsj(i32 2)
; CHECK-DEFAULT-NEXT:    ret void
;
entry:
  %groupid0 = call i64 @_Z14get_num_groupsj(i32 0)
  %groupid1 = call i64 @_Z14get_num_groupsj(i32 1)
  %groupid2 = call i64 @_Z14get_num_groupsj(i32 2)
  ret void
}

declare i64 @_Z15get_global_sizej(i32 %x)
declare i64 @_Z14get_local_sizej(i32 %x)
declare i64 @_Z23get_enqueued_local_sizej(i32 %x)
declare i64 @_Z14get_num_groupsj(i32 %x)

!sycl.kernels = !{!0}

!0 = !{ptr @gsize, ptr @lsize, ptr @enq_lsize, ptr @groupsize}

; DEBUGIFY-NOT: WARNING
