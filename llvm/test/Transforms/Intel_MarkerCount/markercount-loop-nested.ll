; NOTE: Assertions have been autogenerated by utils/update_test_checks.py
; REQUIRES: intel_feature_markercount
; RUN: opt %s -O1 -S -loop-marker-count=me -mtriple=x86_64 -stop-after=markercount-intrinsic-inserter | FileCheck %s

define i32 @f(i1 %cmp2) {
; CHECK-LABEL: @f(
; CHECK-NEXT:  entry:
; CHECK-NEXT:    br label [[LOOP_OUTER:%.*]]
; CHECK:       loop.outer:
; CHECK-NEXT:    tail call void @llvm.mark.loop.header()
; CHECK-NEXT:    br label [[LOOP_INNER:%.*]]
; CHECK:       loop.inner:
; CHECK-NEXT:    tail call void @llvm.mark.loop.header()
; CHECK-NEXT:    br i1 [[CMP2:%.*]], label [[LOOP_INNER]], label [[LOOP_OUTER]]
;
entry:
  br label %loop.outer

loop.outer:                                        ; preds = %loop.inner, %entry
  br label %loop.inner

loop.inner:                                        ; preds = %loop.inner, %loop.outer
  br i1 %cmp2, label %loop.inner, label %loop.outer
}
