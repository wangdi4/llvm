; NOTE: Assertions have been autogenerated by utils/update_analyze_test_checks.py
; RUN: opt < %s -mtriple=x86_64-apple-darwin -cost-model -analyze -mattr=+sse4.2 | FileCheck %s --check-prefixes=X86_64-SSE
; RUN: opt < %s -mtriple=x86_64-apple-darwin -cost-model -analyze -mattr=+avx2 | FileCheck %s --check-prefixes=X86_64-AVX2
; RUN: opt < %s -mtriple=x86_64-apple-darwin -cost-model -analyze -mattr=+avx512f,+avx512dq,,+avx512bw,+avx512vl | FileCheck %s --check-prefixes=X86_64-AVX512-VL-BW

define i32 @fpext_vXfloat() {
; X86_64-SSE-LABEL: 'fpext_vXfloat'
; X86_64-SSE-NEXT:  Cost Model: Found an estimated cost of 7 for instruction: %V3f64 = fptrunc <3 x double> undef to <3 x float>
; X86_64-SSE-NEXT:  Cost Model: Found an estimated cost of 17 for instruction: %V7f64 = fptrunc <7 x double> undef to <7 x float>
; X86_64-SSE-NEXT:  Cost Model: Found an estimated cost of 21 for instruction: %V9f64 = fptrunc <9 x double> undef to <9 x float>
; X86_64-SSE-NEXT:  Cost Model: Found an estimated cost of 81 for instruction: %V33f64 = fptrunc <33 x double> undef to <33 x float>
; X86_64-SSE-NEXT:  Cost Model: Found an estimated cost of 0 for instruction: ret i32 undef
;
; X86_64-AVX2-LABEL: 'fpext_vXfloat'
; X86_64-AVX2-NEXT:  Cost Model: Found an estimated cost of 1 for instruction: %V3f64 = fptrunc <3 x double> undef to <3 x float>
; X86_64-AVX2-NEXT:  Cost Model: Found an estimated cost of 3 for instruction: %V7f64 = fptrunc <7 x double> undef to <7 x float>
; X86_64-AVX2-NEXT:  Cost Model: Found an estimated cost of 28 for instruction: %V9f64 = fptrunc <9 x double> undef to <9 x float>
; X86_64-AVX2-NEXT:  Cost Model: Found an estimated cost of 106 for instruction: %V33f64 = fptrunc <33 x double> undef to <33 x float>
; X86_64-AVX2-NEXT:  Cost Model: Found an estimated cost of 0 for instruction: ret i32 undef
;
; X86_64-AVX512-VL-BW-LABEL: 'fpext_vXfloat'
; X86_64-AVX512-VL-BW-NEXT:  Cost Model: Found an estimated cost of 1 for instruction: %V3f64 = fptrunc <3 x double> undef to <3 x float>
; X86_64-AVX512-VL-BW-NEXT:  Cost Model: Found an estimated cost of 1 for instruction: %V7f64 = fptrunc <7 x double> undef to <7 x float>
; X86_64-AVX512-VL-BW-NEXT:  Cost Model: Found an estimated cost of 30 for instruction: %V9f64 = fptrunc <9 x double> undef to <9 x float>
; X86_64-AVX512-VL-BW-NEXT:  Cost Model: Found an estimated cost of 114 for instruction: %V33f64 = fptrunc <33 x double> undef to <33 x float>
; X86_64-AVX512-VL-BW-NEXT:  Cost Model: Found an estimated cost of 0 for instruction: ret i32 undef
;
  %V3f64 = fptrunc <3 x double> undef to <3 x float>
  %V7f64 = fptrunc <7 x double> undef to <7 x float>
  %V9f64 = fptrunc <9 x double> undef to <9 x float>
  %V33f64 = fptrunc <33 x double> undef to <33 x float>
  ret i32 undef
}

define i32 @fpext_vXf16() {
; X86_64-SSE-LABEL: 'fpext_vXf16'
; X86_64-SSE-NEXT:  Cost Model: Found an estimated cost of 3 for instruction: %V3f64 = fptrunc <3 x double> undef to <3 x half>
; X86_64-SSE-NEXT:  Cost Model: Found an estimated cost of 7 for instruction: %V7f64 = fptrunc <7 x double> undef to <7 x half>
; X86_64-SSE-NEXT:  Cost Model: Found an estimated cost of 9 for instruction: %V9f64 = fptrunc <9 x double> undef to <9 x half>
; X86_64-SSE-NEXT:  Cost Model: Found an estimated cost of 33 for instruction: %V33f64 = fptrunc <33 x double> undef to <33 x half>
; X86_64-SSE-NEXT:  Cost Model: Found an estimated cost of 63 for instruction: %V63f64 = fptrunc <63 x double> undef to <63 x half>
; X86_64-SSE-NEXT:  Cost Model: Found an estimated cost of 3 for instruction: %V3f32 = fptrunc <3 x float> undef to <3 x half>
; X86_64-SSE-NEXT:  Cost Model: Found an estimated cost of 7 for instruction: %V7f32 = fptrunc <7 x float> undef to <7 x half>
; X86_64-SSE-NEXT:  Cost Model: Found an estimated cost of 9 for instruction: %V9f32 = fptrunc <9 x float> undef to <9 x half>
; X86_64-SSE-NEXT:  Cost Model: Found an estimated cost of 33 for instruction: %V33f32 = fptrunc <33 x float> undef to <33 x half>
; X86_64-SSE-NEXT:  Cost Model: Found an estimated cost of 63 for instruction: %V63f32 = fptrunc <63 x float> undef to <63 x half>
; X86_64-SSE-NEXT:  Cost Model: Found an estimated cost of 0 for instruction: ret i32 undef
;
; X86_64-AVX2-LABEL: 'fpext_vXf16'
; X86_64-AVX2-NEXT:  Cost Model: Found an estimated cost of 3 for instruction: %V3f64 = fptrunc <3 x double> undef to <3 x half>
; X86_64-AVX2-NEXT:  Cost Model: Found an estimated cost of 7 for instruction: %V7f64 = fptrunc <7 x double> undef to <7 x half>
; X86_64-AVX2-NEXT:  Cost Model: Found an estimated cost of 9 for instruction: %V9f64 = fptrunc <9 x double> undef to <9 x half>
; X86_64-AVX2-NEXT:  Cost Model: Found an estimated cost of 33 for instruction: %V33f64 = fptrunc <33 x double> undef to <33 x half>
; X86_64-AVX2-NEXT:  Cost Model: Found an estimated cost of 63 for instruction: %V63f64 = fptrunc <63 x double> undef to <63 x half>
; X86_64-AVX2-NEXT:  Cost Model: Found an estimated cost of 3 for instruction: %V3f32 = fptrunc <3 x float> undef to <3 x half>
; X86_64-AVX2-NEXT:  Cost Model: Found an estimated cost of 7 for instruction: %V7f32 = fptrunc <7 x float> undef to <7 x half>
; X86_64-AVX2-NEXT:  Cost Model: Found an estimated cost of 9 for instruction: %V9f32 = fptrunc <9 x float> undef to <9 x half>
; X86_64-AVX2-NEXT:  Cost Model: Found an estimated cost of 33 for instruction: %V33f32 = fptrunc <33 x float> undef to <33 x half>
; X86_64-AVX2-NEXT:  Cost Model: Found an estimated cost of 63 for instruction: %V63f32 = fptrunc <63 x float> undef to <63 x half>
; X86_64-AVX2-NEXT:  Cost Model: Found an estimated cost of 0 for instruction: ret i32 undef
;
; X86_64-AVX512-VL-BW-LABEL: 'fpext_vXf16'
; X86_64-AVX512-VL-BW-NEXT:  Cost Model: Found an estimated cost of 3 for instruction: %V3f64 = fptrunc <3 x double> undef to <3 x half>
; X86_64-AVX512-VL-BW-NEXT:  Cost Model: Found an estimated cost of 7 for instruction: %V7f64 = fptrunc <7 x double> undef to <7 x half>
; X86_64-AVX512-VL-BW-NEXT:  Cost Model: Found an estimated cost of 9 for instruction: %V9f64 = fptrunc <9 x double> undef to <9 x half>
; X86_64-AVX512-VL-BW-NEXT:  Cost Model: Found an estimated cost of 33 for instruction: %V33f64 = fptrunc <33 x double> undef to <33 x half>
; X86_64-AVX512-VL-BW-NEXT:  Cost Model: Found an estimated cost of 63 for instruction: %V63f64 = fptrunc <63 x double> undef to <63 x half>
; X86_64-AVX512-VL-BW-NEXT:  Cost Model: Found an estimated cost of 3 for instruction: %V3f32 = fptrunc <3 x float> undef to <3 x half>
; X86_64-AVX512-VL-BW-NEXT:  Cost Model: Found an estimated cost of 7 for instruction: %V7f32 = fptrunc <7 x float> undef to <7 x half>
; X86_64-AVX512-VL-BW-NEXT:  Cost Model: Found an estimated cost of 9 for instruction: %V9f32 = fptrunc <9 x float> undef to <9 x half>
; X86_64-AVX512-VL-BW-NEXT:  Cost Model: Found an estimated cost of 33 for instruction: %V33f32 = fptrunc <33 x float> undef to <33 x half>
; X86_64-AVX512-VL-BW-NEXT:  Cost Model: Found an estimated cost of 63 for instruction: %V63f32 = fptrunc <63 x float> undef to <63 x half>
; X86_64-AVX512-VL-BW-NEXT:  Cost Model: Found an estimated cost of 0 for instruction: ret i32 undef
;
  %V3f64 = fptrunc <3 x double> undef to <3 x half>
  %V7f64 = fptrunc <7 x double> undef to <7 x half>
  %V9f64 = fptrunc <9 x double> undef to <9 x half>
  %V33f64 = fptrunc <33 x double> undef to <33 x half>
  %V63f64 = fptrunc <63 x double> undef to <63 x half>

  %V3f32 = fptrunc <3 x float> undef to <3 x half>
  %V7f32 = fptrunc <7 x float> undef to <7 x half>
  %V9f32 = fptrunc <9 x float> undef to <9 x half>
  %V33f32 = fptrunc <33 x float> undef to <33 x half>
  %V63f32 = fptrunc <63 x float> undef to <63 x half>
  ret i32 undef
}
