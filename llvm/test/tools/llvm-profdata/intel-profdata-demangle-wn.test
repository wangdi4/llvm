

# Test llvm-profdata option to print demangled function names

# RUN: llvm-profdata show -all-functions -demangle=0 %s | FileCheck %s --check-prefix=MANGLED
# RUN: llvm-profdata show -all-functions -demangle=1 %s | FileCheck %s --check-prefix=DEMANGLED

# MANGLED: ?Convolve@@YAXHHPEAM0PEAHH@Z:
# MANGLED: convolvexmain.cpp:?do_test@@YAMHHHHPEAHPEAM1@Z:
# MANGLED: convolvexmain.cpp:?init@@YAXHHHPEAHPEAM1@Z:
# MANGLED: main:

# DEMANGLED: void __cdecl Convolve(int, int, float *, float *, int *, int):
# DEMANGLED: convolvexmain.cpp:float __cdecl do_test(int, int, int, int, int *, float *, float *):
# DEMANGLED: convolvexmain.cpp:void __cdecl init(int, int, int, int *, float *, float *):
# DEMANGLED: main:

# IR level Instrumentation Flag
:ir
?Convolve@@YAXHHPEAM0PEAHH@Z
# Func Hash:
391331301368674999
# Num Counters:
4
# Counter Values:
5400000
1350000
51000
2010
# Num Value Kinds:
1
# ValueKind = IPVK_LoopTripCount:
2
# NumValueSites:
1
1
4:1350000

__local_stdio_printf_options
# Func Hash:
742261418966908927
# Num Counters:
1
# Counter Values:
4

_vfprintf_l
# Func Hash:
742261418966908927
# Num Counters:
1
# Counter Values:
1

convolvexmain.cpp:?do_test@@YAMHHHHPEAHPEAM1@Z
# Func Hash:
798733566382720768
# Num Counters:
3
# Counter Values:
51000
2010
2

convolvexmain.cpp:?init@@YAXHHHPEAHPEAM1@Z
# Func Hash:
798733564482556826
# Num Counters:
3
# Counter Values:
125
42500
2

main
# Func Hash:
238984484093187152
# Num Counters:
3
# Counter Values:
0
1
1

printf
# Func Hash:
742261418966908927
# Num Counters:
1
# Counter Values:
1

