// NOTE: Assertions have been autogenerated by utils/update_cc_test_checks.py
// REQUIRES: intel_feature_isa_avx512_vpmm
// RUN: %clang_cc1 -flax-vector-conversions=none -ffreestanding %s -triple=x86_64-linux-gnu -target-feature +avx512vpmm -target-feature +avx512vl -emit-llvm -o - -Wall -Werror | FileCheck %s

#include <immintrin.h>

void test_mm_vmmxf16_ps(__m128 *HighPtr, __m128 *LowPtr,
                           __m128h Src1, __m128h Src2) {
  // CHECK-LABEL: @test_mm_vmmxf16_ps(
  // CHECK: call { <4 x float>, <4 x float> } @llvm.x86.vpmm.vmmxf16ps.128(<4 x float> {{%.*}}, <4 x float> {{%.*}}, <8 x half> {{%.*}}, <8 x half> {{%.*}})
  _mm_vmmxf16_ps(LowPtr, HighPtr, Src1, Src2, *LowPtr, *HighPtr);
}

void test_mm256_vmmxf16_ps(__m256 *HighPtr, __m256 *LowPtr,
                           __m256h Src1, __m256h Src2) {
  // CHECK-LABEL: @test_mm256_vmmxf16_ps(
  // CHECK: call { <8 x float>, <8 x float> } @llvm.x86.vpmm.vmmxf16ps.256(<8 x float> {{%.*}}, <8 x float> {{%.*}}, <16 x half> {{%.*}}, <16 x half> {{%.*}})
  _mm256_vmmxf16_ps(LowPtr, HighPtr, Src1, Src2, *LowPtr, *HighPtr);
}

__m128 test_mm_vmmif16_ps(__m128h Src1, __m128h Src2, __m128 SrcDst) {
  // CHECK-LABEL: @test_mm_vmmif16_ps(
  // CHECK: call <4 x float> @llvm.x86.vpmm.vmmif16ps.128(<4 x float> {{%.*}}, <8 x half> {{%.*}}, <8 x half> {{%.*}}, i32 0)
  return _mm_vmmif16_ps(Src1, Src2, SrcDst, 0);
}

__m256 test_mm256_vmmif16_ps(__m256h Src1, __m256h Src2, __m256 SrcDst) {
  // CHECK-LABEL: @test_mm256_vmmif16_ps(
  // CHECK: call <8 x float> @llvm.x86.vpmm.vmmif16ps.256(<8 x float> {{%.*}}, <16 x half> {{%.*}}, <16 x half> {{%.*}}, i32 0)
  return _mm256_vmmif16_ps(Src1, Src2, SrcDst, 0);
}
