# INTEL_CUSTOMIZATION
import os
import platform

import lit.util

# CMPLRTOOLS-17951: Use GCC in PATH (set by ICS) instead of system GCC for
# newer C++ standard library to prevent failure of tests depending on C++14
# complaint library
# FIXME: Clang driver should be detecting GCC in PATH and use its library
# automatically
if platform.system() == "Linux":
    gcc_exe = lit.util.which('gcc')
    config.substitutions = list(config.substitutions)
    config.substitutions.insert(0, (r'%clang\b', ' ' + config.clang
        + ' --gcc-toolchain='
        + os.path.normpath(os.path.join(os.path.dirname(gcc_exe), ".."))))
# end INTEL_CUSTOMIZATION
